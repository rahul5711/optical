<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>vision world invoice</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@100..900&family=Noto+Sans+Gothic&display=swap" rel="stylesheet">
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<style>
    html body {
        zoom: 100%;
           font-family: 'Calibri', sans-serif;
        padding: 3%;
    }

    .table_header {
        width: 100%;
    }

    .table_header tr th {
        padding: 0;
    }

    .powerTbl {
        border-collapse: collapse;
        width: 100%;
    }

    .powerTbl td,
    .powerTbl th {
        border: 2px solid #ffffff;
        text-align: center;
        padding: 5px 3px;
    }

    .powerTbl tr:nth-child(even) {
        background-color: #d4e7f5;
       padding: 5px 3px;
    }

    .powerTbl tr:nth-child(odd) {
        background-color: #abcbea;
         padding: 5px 3px;
    }

    .totaltr tr {
        text-align: left;
        background-color: #abcbea;
    }

    .totaltr tr th {
        padding-left: 10px !important;
    }

    .watermark {
        position: absolute;
        z-index: -11;
        top: 15%;
        opacity: .2;
        width: 70%;
        margin-left: 12%;
        /* background-color: blue; */
    }

    .font-sizes{
        font-size: 16px;
    }
</style>

<body style="position: relative;">

    <img src='http://localhost:3000/assest/v-w-water-r.png' alt="LOGO" class="watermark">

    <section>
        <table class="table_header">
            <tr style="position: relative;">
                <th style="width: 15%; position: absolute;">
                    <img src='http://localhost:3000/assest/v-w-hin.jpeg' alt="" width="100%" >
                </th>
                <th>
                    <img src='http://localhost:3000/assest/vi-w.jpeg' alt="" width="50%">
                </th>
            </tr>
            <tr>

 		 <th colspan="2" >
                 <b  style="font-size: 14px;   font-family: 'Century Gothic', sans-serif !important; ">   S.No 571/572 Shop No - 12, Kumar Park, Bibwewadi - Kondhwa RD, Pune - 411037  <br>
                    Contact   <img src='http://localhost:3000/assest/call-svgrepo-com.png' alt="" width="1.3%"> <img src='http://localhost:3000/assest/whatsapp-128-svgrepo-com.png' alt="" width="1.3%"> +91 9975988875 </b>
                </th>
                </th>
            </tr>
        </table>
    </section>

    <section style="  border-top: 3px solid;  border-bottom: 3px solid; margin-top: 2%; width: 100%; padding: 2% 0; height: 70px;">
        <table class="font-sizes" style="float: left; width: 50%; text-align: left; ">
            <tr>
                <th>Name </th>
                <td>
                    <%=data.customer.Title%>
                        <%=data.customer.Name%>
                </td>
            </tr>
            <tr>
                <th>Mobile No </th>
                <td>
                    <%=data.customer.MobileNo1%>
                </td>
            </tr>
            <tr>
                <th>Sale Person </th>
                <td>
                    <%=data.employee%>
                </td>
            </tr>
        </table>
        <table class="font-sizes" style="float: right; width: 40%; text-align: left; ">
            <tr>
                <th>Invoice No. </th>
                <td>
                    <%=data.billMaster.InvoiceNo%>
                </td>
            </tr>
            <tr>
                <th>Date</th>
                <td>
                    <%=data.billMaster.BillDate%>
                </td>
            </tr>
            <tr>
                <th>Del Date </th>
                <td>
                    <%=data.billMaster.DeliveryDate%>
                </td>
            </tr>
        </table>
    </section>

    <% if (data.ShowPower==true){%>
        <section class="font-sizes" style="margin-bottom: 2%; margin-top: 3%; ">
            <% if(data.EyeMeasurement !==null && data.EyeMeasurement.length !==0){ data.EyeMeasurement.forEach(function
                (i, index) { %>
                <table class="powerTbl">
                    <tr style="background-color: #5a9bd4; text-align: center;">
                        <th colspan="6">RIGHT EYE</th>
                        <th colspan="5">LEFT EYE</th>
                    </tr>
                    <tr>
                        <th style="background-color: #5a9bd4;">VN</th>
                        <th>SPH</th>
                        <th>CYL</th>
                        <th>AXIS</th>
                        <th>VA</th>
                        <th>ADD</th>
                        <th>SPH</th>
                        <th>CYL</th>
                        <th>AXIS</th>
                        <th>VA</th>
                        <th>ADD</th>
                    </tr>
                    <tr>
                        <th style="background-color: #5a9bd4;">DV</th>
                        <td>
                            <%=i.REDPSPH%>
                        </td>
                        <td>
                            <%=i.REDPCYL%>
                        </td>
                        <td>
                            <%=i.REDPAxis%>
                        </td>
                        <td>
                            <%=i.REDPVA%>
                        </td>
                        <td rowspan="2">
                            <%=i.R_Addition%>
                        </td>
                        <td>
                            <%=i.LEDPSPH%>
                        </td>
                        <td>
                            <%=i.LEDPCYL%>
                        </td>
                        <td>
                            <%=i.LEDPAxis%>
                        </td>
                        <td>
                            <%=i.LEDPVA%>
                        </td>
                        <td rowspan="2">
                            <%=i.L_Addition%>
                        </td>
                    </tr>
                    <tr>
                        <th style="background-color: #5a9bd4; ">NV</th>
                        <td>
                            <%=i.RENPSPH%>
                        </td>
                        <td>
                            <%=i.RENPCYL%>
                        </td>
                        <td>
                            <%=i.RENPAxis%>
                        </td>
                        <td>
                            <%=i.RENPVA%>
                        </td>
                        <td>
                            <%=i.LENPSPH%>
                        </td>
                        <td>
                            <%=i.LENPCYL%>
                        </td>
                        <td>
                            <%=i.LENPAxis%>
                        </td>
                        <td>
                            <%=i.LENPVA%>
                        </td>
                    </tr>
                </table>
                <%})}%>
        </section>
        <%}%>

            <section style="margin-top: 3%;">

                <table class="powerTbl">
                    <thead>
                        <tr class="font-sizes" style="background-color: #5a9bd4; text-align: center; ">
                            <th>SNo.</th>
                            <% if (data.shopdetails.HSNCode==="true" ){%>
                                <th>HSNCode</th>
                                <%}%>
                                    <th>Description</th>
                                    <th>Qty</th>
                                    <% if (data.shopdetails.Rate==="true" ){%>
                                        <th>Rate</th>
                                        <%}%>
                                            <% if (data.shopdetails.Discounts==="true" ){%>
                                                <th>Dis.</th>
                                                <%}%>
                                                    <% if (data.shopdetails.SubTotal==="true" ){%>
                                                        <th>SubTotal</th>
                                                        <%}%>
                                                            <% if (data.shopdetails.Tax==="true" &&
                                                                data.bill==='Tax Invoice' ){%>
                                                                <% if (data.GSTTypes=="CGST-SGST" ) { %>
                                                                    <th>CGST</th>
                                                                    <th>SGST</th>
                                                                    <%} else if (data.GSTTypes=='IGST' ) { %>
                                                                        <th>IGST</th>
                                                                        <% } else if (data.GSTTypes=='VAT' ) { %>
                                                                            <th>VAT</th>
                                                                            <% } else { %>
                                                                                <th>None</th>
                                                                                <% } %>
                                                                                    <%}%>
                                                                                        <% if
                                                                                            (data.shopdetails.Total==="true"
                                                                                            ){%>
                                                                                            <th>
                                                                                                <%= data.TotalValue %>
                                                                                            </th>
                                                                                            <%}%>
                        </tr>
                    </thead>
                    <tbody <% %> style="text-align: center;font-size: 12px;">
                        <% if(data.billItemList.length !=0 ){ data.billItemList.forEach(function (i, index) { %>
                            <tr style="height: auto;" class="font-sizes">
                                <td style="background-color: #5a9bd4;">
                                    <%= index+1 %>
                                </td>
                                <% if (data.shopdetails.HSNCode==="true" ){%>
                                    <td>
                                        <%= i.HSNCode %>
                                    </td>
                                    <%}%>
                                        <td style="width: 30%; font-size: 14px;">
                                            <%= i.ProductName %>
                                                <% if (i.Warranty !='' && i.Warranty !="undefined" ){%>
                                                    /<%= i.Warranty %>
                                                        <%}%>
                                                            <% if (i.Remark !='' && i.Remark !="undefined" ){%>
                                                                /<%= i.Remark %>
                                                                    <%}%>
                                        </td>
                                        <td>
                                            <%= i.Quantity %>
                                        </td>
                                        <% if (data.shopdetails.Rate==="true" ){%>
                                            <td>
                                                <%= i.UnitPrice %>
                                            </td>
                                            <%}%>
                                                <% if (data.shopdetails.Discounts==="true" ){%>
                                                    <td>
                                                        <%= i.DiscountAmount %>
                                                    </td>
                                                    <%}%>
                                                        <% if (data.shopdetails.SubTotal==="true" ){%>
                                                            <td>
                                                                <%= i.SubTotal %>
                                                            </td>
                                                            <%}%>
                                                                <% if (data.shopdetails.Tax==="true" &&
                                                                    data.bill==='Tax Invoice' ){%>
                                                                    <% if (data.GSTTypes=="CGST-SGST" ) { %>
                                                                        <td>
                                                                            <%= i.GSTAmount %> <br> @ <%=
                                                                                    i.GSTPercentage %>
                                                                        </td>
                                                                        <td>
                                                                            <%= i.GSTAmount %> <br> @ <%=
                                                                                    i.GSTPercentage %>
                                                                        </td>
                                                                        <%} else { %>
                                                                            <td>
                                                                                <%= i.GSTAmount %> <br> @ <%=
                                                                                        i.GSTPercentage %>
                                                                            </td>
                                                                            <% } %>
                                                                                <%}%>

                                                                                    <% if
                                                                                        (data.shopdetails.Total==="true"
                                                                                        ){%>
                                                                                        <td>
                                                                                            <%= i.TotalAmount %>
                                                                                        </td>
                                                                                        <%}%>

                            </tr>
                            <%})}%>

                                <!-- serviceList start -->
                                <% if(data.serviceList.length !==0 ){ data.serviceList.forEach(function (i, index) { %>
                                    <tr class="font-sizes">
                                        <td> -</td>
                                        <% if (data.shopdetails.HSNCode==="true" ){%>
                                            <td></td>
                                            <%}%>
                                                <td>
                                                    <%= i.ServiceType %>/<%= i.Description %>
                                                </td>
                                                <td> </td>
                                                <% if (data.shopdetails.Rate==="true" ){%>
                                                    <td>
                                                        <%= i.Price %>
                                                    </td>
                                                    <%}%>
                                                        <% if (data.shopdetails.Discounts==="true" ){%>
                                                            <td>
                                                                <%= i.DiscountAmount %>
                                                            </td>
                                                            <%}%>
                                                                <% if (data.shopdetails.SubTotal==="true" ){%>
                                                                    <td>
                                                                        <%= i.SubTotal %>
                                                                    </td>
                                                                    <%}%>
                                                                        <% if (data.shopdetails.Tax==="true" &&
                                                                            data.bill==='Tax Invoice' ){%>
                                                                            <% if (data.GSTTypes=="CGST-SGST" ) { %>
                                                                                <td>
                                                                                    <%= i.GSTAmount %> <br> @ <%=
                                                                                            i.GSTPercentage %>
                                                                                </td>
                                                                                <td>
                                                                                    <%= i.GSTAmount %> <br> @ <%=
                                                                                            i.GSTPercentage %>
                                                                                </td>
                                                                                <%} else { %>
                                                                                    <td>
                                                                                        <%= i.GSTAmount %> <br> @ <%=
                                                                                                i.GSTPercentage %>
                                                                                    </td>
                                                                                    <% } %>
                                                                                        <%}%>
                                                                                            <% if
                                                                                                (data.shopdetails.Total==="true"
                                                                                                ){%>
                                                                                                <td>
                                                                                                    <%= i.TotalAmount %>
                                                                                                </td>
                                                                                                <%}%>
                                    </tr>
                                    <%})}%>
                    </tbody>


                </table>

            </section>


            <section style="width: 100%;">
                <table class="font-sizes" style="width: 60%; float: left; text-align: left; ">
                    <tr>
                        <th>
                            <h4 <% %> style="color: red;padding: 0; margin:0; padding-top:10px;">Important Note</h4>
                        </th>
                    </tr>
                    <tr>
                        <td>
                            <% if(data.welComeNoteShop.length !==0){ data.welComeNoteShop.forEach(function (i, index) {
                                %>
                                <p <% %>  style=" line-height:20px; font-size: 15px; 
                                    padding: 0; margin:0;">
                                    <%=index+1%>. <%=i.Content%>
                                </p>
                                <%})}%>
                        </td>
                    </tr>
                    <tr>
                        <td>
                          <h4 <% %> style="color: <%= data.Color %>;padding: 0; margin:0; padding-top:10px;"> <%= data.shopdetails.ShopTiming %>  </h4> 
                        </td>
                    </tr>

                </table>
                <table class="totaltr font-sizes" style="width: 35%;  float: right;  padding-top:10px;">
                    <tr>
                        <th>Total</th>
                        <th >
                            <%= data.subtotals %>
                        </th>
                    </tr>
                    <tr>
                        <th>Add Disc.</th>
                        <th>
                            <%= data.billMaster.DiscountAmount + data.billMaster.AddlDiscount%>
                        </th>
                    </tr>
                    <tr>
                        <th>Grand Total</th>
                        <th>
                            <%= data.billMaster.TotalAmount %>
                        </th>
                    </tr>
                    <tr>
                        <th>Advance</th>
                        <th>
                            <%= data.recivePayment.toFixed(2) %>
                        </th>
                    </tr>
                    <tr>
                        <th>Balance</th>
                        <th>
                            <%= data.CurrentInvoiceBalance %>
                        </th>
                    </tr>
                    <tr>
                        <th>Payment By</th>
                        <th>
                            <% if(data.paidlist.length !==0){data.paidlist.forEach(function (i, index) { %>
                                <% if (i.PaymentMode !=='Payment Initiated' ){%>
                                    <span style="font-size: 12px;">
                                        <%=i.PaymentMode%>/
                                    </span>
                                    <%}%>
                                        <%})}%>
                        </th>
                    </tr>
                    <tr style="height:30px">
                        <th colspan="2" style="font-size: 14px; letter-spacing: .1px;"> You've Saved <%=data.SavedDiscount%> Rs. on this
                                Invoice!</th>
                    </tr>
                </table>
            </section>

                <section style="width: 100%;">
                        <p  style="font-size: 16px; letter-spacing: .1px; width: 100%; padding-top: 40%; padding-left: 70%;"> Authorized Stamp & Sign</p>
                </section>

</body>

</html>