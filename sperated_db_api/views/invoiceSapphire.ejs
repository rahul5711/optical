<html>
<link rel="stylesheet" href="http://localhost:3000/assest/invoice.css">
<style>
    * {
        border-bottom: 1xp solid;
    }
    .headingName {
         position: absolute;
         margin-left: 43%;
         width: 30%;
         color: red;
         margin-top: 0px;
         font-size: 16px !important;
      }
    html body{
        zoom: 100%;
    }
    .watermark{
        position: absolute;
        z-index: -11;
        top: 10px;
        /* background-color: blue; */
    }

    .powerTbl td {
  border: 1px solid black;
  border-collapse: collapse;
}
</style>

<body >
  
    <!-- header section start -->
    <%- include('./header.ejs', {pageNumber: 1}) %>
    
    <!-- <% if (data.billformate.BillHeader==3){%>
        <header class="headerSize" <% %> style='width:<%= data.HeaderWidth %>; height: <%= data.HeaderHeight %>;'>
                        <div class="row">
                            <div class="col1" <% %> style="text-align: <%= data.ImageAlign %>;">
                                    <img src=<%=data.LogoURL%> alt="LOGO" style='width:<%= data.ImageWidth %>; height:
                                        <%= data.ImageHeight %>;'>
                            </div>
                            <div class="col2">
                                <span <% %> style='font-size:<%= data.ShopNameFont %>; font-weight: <%=
                                            data.ShopNameBold %>; color: <%= data.Color %>;'>
                                                <%=data.shopdetails.Name%>
                                </span> <br>
                                <span <% %> style='line-height:<%= data.LineSpace %>;font-size:<%= data.ShopDetailFont
                                            %>;'>
                                            <span>
                                                <%=data.shopdetails.Address%>
                                            </span> <br>
                                            <span>
                                                <%=data.shopdetails.MobileNo1%>
                                                    <% if (data.shopdetails.MobileNo2){%>
                                                        ,
                                                        <%}%>
                                                            <%=(data.shopdetails.MobileNo2 !=='null' ) ?
                                                                data.shopdetails.MobileNo2 : '' %>
                                            </span><br>
                                            <span>
                                                <%=data.shopdetails.Email%>
                                            </span><br>
                                            <span>
                                                <%=(data.shopdetails.PhoneNo !=='null' ) ? data.shopdetails.PhoneNo : ''
                                                    %>
                                            </span>
                                </span>
                            </div>
                        </div>
        </header>
        <%}%> -->
            <!-- header section  end -->
  <section style="position: relative;">
    <img src=<%=data.WaterMark%> alt="LOGO" class="watermark"  style="width:<%= data.WaterMarkWidth %>;height:<%= data.WaterMarkHeigh %>;opacity:<%= data.WaterMarkOpecity %>;left:<%= data.WaterMarkLeft %>;right:<%= data.WaterMarkRight %>; ">

            <!-- heading Bill line  start-->
              <section>
                <div style="height: 15px;">
                    <div <% %>  style="border-bottom: 1px solid <%= data.Color %>; width: 40%; position:absolute; margin-top: 1%;"> </div>
                    <div <% %> style="border-bottom: 1px solid <%= data.Color %>; width: 40%; float: right; position: relative; margin-top: 1%;"></div>
                    <span <% %> class="headingName" style="color: <%= data.Color %>;" ><%=data.bill%></span>
                 </div>
              </section>
            <!-- heading Bill line  end-->

            <!-- Customer Details start  -->
            <section style="width: 100%;">
                <div class="CustomerRow">
                    <div class="col1">
                        <ul class="ul1" <% %> style="font-size:<%= data.CustomerFont %> ; line-height:<%=
                                    data.CustomerLineSpace %>;">
                                    <li>
                                        <%= data.invoiceNo %>
                                    </li>
                                    <li>Name</li>
                                    <li>Mobile No</li>
                                    <li>Sale Person</li>
                        </ul>
                        <ul class="ul2" <% %> style="font-size:<%= data.CustomerFont %> ; line-height:<%=
                                    data.CustomerLineSpace %>;">
                                    <li>
                                        <%=data.billMaster.InvoiceNo%>
                                    </li>
                                    <li>
                                        <%=data.customer.Title%> <%=data.customer.Name%>
                                    </li>
                                    <li>
                                        <%=data.customer.MobileNo1%>
                                    </li>
                                    <li>
                                        <%=data.employee%>
                                    </li>
                        </ul>
                    </div>
                    <div class="col3">
                       
                    </div>
                    <div class="col2">
                        <ul class="ul1" <% %> style="font-size:<%= data.CustomerFont %> ; line-height:<%=
                                    data.CustomerLineSpace %>;">
                                    <li>Date</li>
                                    <li>Del. Date</li>
                                    <li>
                                        <% if (data.customer.GSTNo != ''){%>
                                        GSTNo
                                        <%}%>
                                    </li>
                                    <li>
                                        <% if (data.customer.RefferedByDoc != ''){%>
                                        Rx BY
                                        <%}%>
                                    </li>
                        </ul>
                        <ul class="ul2" <% %> style="font-size:<%= data.CustomerFont %> ; line-height:<%=
                                    data.CustomerLineSpace %>;">
                                    <li>
                                        <%=data.billMaster.BillDate%>
                                    </li>
                                    <li>
                                        <%=data.billMaster.DeliveryDate%>
                                    </li>
                                    <li>
                                        <% if (data.customer.GSTNo != ''){%>
                                        <%=data.customer.GSTNo%>
                                        <%}%>
                                    </li>
                                    <li>
                                        <% if (data.customer.RefferedByDoc != ''){%>
                                        <%=data.customer.RefferedByDoc%>
                                        <%}%>
                                    </li>
                                   

                        </ul>
                    </div>
                </div>
            </section>
            <!-- Customet Details end  -->

         
            <!-- Product list start  -->
            <section>
                <table <% %> style="width:100%; border-bottom: 1px solid <%= data.Color %>;padding-top: 1%;">
                        <thead style="background-color: rgb(228, 228, 228); text-align: center; font-weight: 600;">
                            <tr <% %> style="text-align: center; font-size: <%= data.TableHeading %> ; height: 30px;">
                                    <th>SNo.</th>
                                    <% if (data.shopdetails.HSNCode==="true" ){%>
                                        <th>HSNCode</th>
                                        <%}%>
                                            <th>Description</th>
                                            <th>Quantity</th>
                                            <% if (data.shopdetails.Rate==="true" ){%>
                                                <th>Rate</th>
                                                <%}%>
                                                    <% if (data.shopdetails.Discounts==="true" ){%>
                                                        <th>Discount</th>
                                                        <%}%>
                                                            <% if (data.shopdetails.SubTotal==="true" ){%>
                                                                <th>SubTotal</th>
                                                                <%}%>
                                                                    <% if (data.shopdetails.Tax==="true" &&
                                                                        data.bill==='Tax Invoice' ){%>
                                                                        <% if (data.GSTTypes=="CGST-SGST"
                                                                            ) { %>
                                                                            <th>CGST</th>
                                                                            <th>SGST</th>
                                                                            <%} else if (data.GSTTypes == 'IGST') { %>
                                                                                <th>IGST</th>
                                                                                <% } else if (data.GSTTypes == 'VAT') { %>
                                                                                    <th>VAT</th>
                                                                                    <% } else { %>
                                                                                    <th>None</th>
                                                                                <% } %>
                                                                                    <%}%>
                                                                                        <% if
                                                                                            (data.shopdetails.Total==="true"
                                                                                            ){%>
                                                                                            <th>
                                                                                                <%= data.TotalValue %>
                                                                                            </th>
                                                                                            <%}%>

                            </tr>
                        </thead>
                        <tbody <% %> style="text-align: center; font-size: <%= data.TableBody %> ;">
                                <% if(data.billItemList.length != 0 ){ data.billItemList.forEach(function (i, index) {
                                    %>
                                    <tr>
                                        <td>
                                            <%= index+1 %>
                                        </td>
                                        <% if (data.shopdetails.HSNCode==="true" ){%>
                                            <td>
                                                <%= i.HSNCode %>
                                            </td>
                                            <%}%>
                                                <td>
                                                    <%= i.ProductName %>  
                                                    <% if (i.Warranty != '' ){%>
                                                    /<%= i.Warranty %>
                                                    <%}%>
                                                </td>
                                                <td>
                                                    <%= i.Quantity %>
                                                </td>
                                                <% if (data.shopdetails.Rate==="true" ){%>
                                                    <td>
                                                        <%= i.UnitPrice %>
                                                    </td>
                                                    <%}%>
                                                        <% if (data.shopdetails.Discounts==="true" ){%>
                                                            <td>
                                                                <%= i.DiscountAmount %>
                                                            </td>
                                                            <%}%>
                                                                <% if (data.shopdetails.SubTotal==="true" ){%>
                                                                    <td>
                                                                        <%= i.SubTotal %>
                                                                    </td>
                                                                    <%}%>
                                                                        <% if (data.shopdetails.Tax==="true" &&
                                                                            data.bill==='Tax Invoice'  ){%>

                                                                            <% if
                                                                                (data.GSTTypes=="CGST-SGST"
                                                                                ) { %>
                                                                                <td>
                                                                                    <%= i.GSTAmount %> <br> @ <%=
                                                                                            i.GSTPercentage %>
                                                                                </td>
                                                                                <td>
                                                                                    <%= i.GSTAmount %> <br> @ <%=
                                                                                            i.GSTPercentage %>
                                                                                </td>
                                                                                <%} else { %>
                                                                                    <td>
                                                                                        <%= i.GSTAmount %> <br> @ <%=
                                                                                                i.GSTPercentage %>
                                                                                    </td>
                                                                                    <% } %>
                                                                                        <%}%>

                                                                                            <% if
                                                                                                (data.shopdetails.Total==="true"
                                                                                                ){%>
                                                                                                <td>
                                                                                                    <%= i.TotalAmount %>
                                                                                                </td>
                                                                                                <%}%>

                                    </tr>

                                    <% for(const Measurement of JSON.parse(i.MeasurementID)){ %>
                                        <tr style="text-align: center;" >
                                            <td></td>
                                             <td></td>
                                            <td colspan="1"> 
                                                <table class="powerTbl" style="width:100%;text-align: center;">
                                                    <tbody>
                                                         <tr>
                                                 <td><b>SIDE</b></td> 
                                                 <td>SPH </td>
                                                 <td>CYL </td>
                                                 <td>AXIS </td>
                                                 <td>VP </td>
                                                 <td>ADD</td>
                                                </tr>
                                                <tr>
                                                    <td><b>R</b></td> 
                                                    <td><%=Measurement.REDPSPH%> </td>
                                                    <td><%=Measurement.REDPCYL%> </td>
                                                    <td><%=Measurement.REDPAxis%> </td>
                                                    <td><%=Measurement.REDPVA%> </td>
                                                    <td><%=Measurement.R_Addition%></td>
                                                   </tr>
                                                   <tr>
                                                    <td><b>L</b> </td>
                                                    <td><%=Measurement.LEDPSPH%>  </td>
                                                    <td><%=Measurement.LEDPCYL%> </td>
                                                    <td><%=Measurement.LEDPAxis%> </td>
                                                    <td><%=Measurement.LEDPVA%> </td>
                                                    <td><%=Measurement.L_Addition%></td>
                                                </tr>
                                                </tbody>
                                                </table>
                                            </td>
                                            
                                        </tr>
                                       
                                      
                                        <% } %>
                                    <%})}%>
                                        <!-- serviceList start -->
                                        <% if(data.serviceList.length !==0 ){ data.serviceList.forEach(function (i,
                                            index) { %>
                                            <tr>
                                                <td>
                                                    <%= index+1 %>
                                                </td>
                                                <% if (data.shopdetails.HSNCode==="true" ){%>
                                                <td></td>
                                                <%}%>

                                                <td>
                                                    <%= i.ServiceType %>/<%= i.Description %>
                                                </td>
                                                <td> </td>

                                                <% if (data.shopdetails.Rate==="true" ){%>
                                                <td>
                                                    <%= i.Price %>
                                                </td>
                                                <%}%>

                                                <% if (data.shopdetails.Discounts==="true" ){%>
                                                <td> </td>
                                                <%}%>

                                                <% if (data.shopdetails.Discounts==="true" ){%>
                                                <td>
                                                    <%= i.SubTotal %>
                                                </td>
                                                <%}%>


                                                <% if (data.shopdetails.Tax==="true" &&
                                                    data.bill==='Tax Invoice'  ){%>

                                                    <% if
                                                        (data.GSTTypes=="CGST-SGST"
                                                        ) { %>
                                                        <td>
                                                            <%= i.GSTAmount %> <br> @ <%=
                                                                    i.GSTPercentage %>
                                                        </td>
                                                        <td>
                                                            <%= i.GSTAmount %> <br> @ <%=
                                                                    i.GSTPercentage %>
                                                        </td>
                                                        <%} else { %>
                                                            <td>
                                                                <%= i.GSTAmount %> <br> @ <%=
                                                                        i.GSTPercentage %>
                                                            </td>
                                                            <% } %>
                                                                <%}%>

                                                                    <% if
                                                                        (data.shopdetails.Total==="true"
                                                                        ){%>
                                                                        <td>
                                                                            <%= i.TotalAmount %>
                                                                        </td>
                                                                        <%}%>
                                            </tr>
                                            <%})}%>
                                                <!-- serviceList end -->
                        </tbody>
                </table>
            </section>
            <!-- Product list  end  -->

            <!-- improtant note billtotal start -->
            <section>
                <div class="billTotalRow">
                    <div class="col1">
                        <h4 <% %> style="color: <%= data.Color %>;padding: 0; margin:0;">Important Note</h4>

                        <% if(data.welComeNoteShop.length !==0){ data.welComeNoteShop.forEach(function (i, index) { %>
                            <p <% %> style="font-size:<%= data.NoteFont %> ; line-height:<%= data.NoteLineSpace %>;
                                        padding: 0; margin:0;">
                                        <%=index+1%>. <%=i.Content%>
                            </p>
                            <%})}%>

                            <% if (data.shopdetails.Tax==="false" && data.bill ==='Bill Of Supply' ){%>
                                <p>
                                 <b <% %> style="color: red; font-size:<%= data.NoteFont %>">Note -</b>   Composition Taxable person, Not eligible to collect tax on supplies.
                                </p>
                             <%}%>
                    </div>
                    <div class="col2">
                        <ul class="ul1" <% %> style="font-size:<%= data.CustomerFont %> ; line-height:<%=
                                    data.CustomerLineSpace %>;">
                                    <% if (data.shopdetails.SubTotal==="true" ){%>
                                        <li>Total</li>
                                        <%}%>

                                            <% if (data.shopdetails.Discounts==="true" ){%>
                                                <li>Discount </li>
                                                <%}%>

                                                    <% if (data.shopdetails.Tax==="true" && data.bill==='Tax Invoice' 
                                                        ){%>
                                                        <li>
                                                            <% if (data.GSTTypes=="CGST-SGST" ) { %>
                                                                (<%= data.GSTTypes %>)
                                                                    <%} else { %>
                                                                        Tax
                                                                        <% } %>
                                                        </li>
                                                        <%}%>

                                                            <li>A Discount</li>
                                                            <li <% %> style="border: 1px solid <%= data.Color %>;">Grand
                                                                    Total </li>
                                                            <li>Advance </li>
                                                            <li>Current Inv. Bal. </li>
                                                            <li>Total Balance </li>
                                                            <li>Payment By </li>
                        </ul>
                        <ul class="ul2" <% %> style="font-size:<%= data.CustomerFont %> ; line-height:<%=
                                    data.CustomerLineSpace %>;">
                                    <!-- <li><%=data.billMaster.SubTotal%></li> -->
                                    <% if (data.shopdetails.SubTotal==="true" ){%>
                                        <li>
                                            <%= data.billMaster.SubTotal %>
                                        </li>
                                        <%}%>

                                            <% if (data.shopdetails.Discounts==="true" ){%>
                                                <li>
                                                    <%= data.billMaster.DiscountAmount %>
                                                </li>
                                                <%}%>

                                                    <% if (data.shopdetails.Tax==="true" && data.bill==='Tax Invoice' 
                                                        ){%>
                                                        <li>
                                                            <% if (data.GSTTypes=="CGST-SGST" ) { %>
                                                                ( <%= data.billMaster.GSTAmount/2 %> / <%=
                                                                        data.billMaster.GSTAmount/2 %>)
                                                                        <%} else { %>
                                                                            <%= data.billMaster.GSTAmount %>
                                                                                <% } %>
                                                        </li>
                                                        <%}%>

                                                            <li>
                                                                <%= data.billMaster.AddlDiscount %>
                                                            </li>
                                                            <li <% %> style="border: 1px solid <%= data.Color %>;"><%=
                                                                        data.billMaster.TotalAmount %>
                                                            </li>
                                                            <li>
                                                                <%= data.recivePayment %>
                                                            </li>
                                                            <li>
                                                                <%= data.CurrentInvoiceBalance %>
                                                            </li>
                                                            <li>
                                                                <%= data.DueAmount %>
                                                            </li>
                                                            <li>
                                                                <% if(data.paidlist.length !==0){
                                                                    data.paidlist.forEach(function (i, index) { %>
                                                                    <% if (i.PaymentMode !=='Payment Initiated' ){%>
                                                                        <span style="font-size: 12px;">
                                                                            <%=i.PaymentMode%>/
                                                                        </span>
                                                                        <%}%>
                                                                            <%})}%>
                                                            </li>
                        </ul>
                    </div>
                </div>
            </section>
            <!-- improtant note billtotal end -->

            <!-- You've Saved  start -->
            <% if (data.shopdetails.CompanyID !== 20){%>
            <% if (data.SavedDiscount !== 0){%>
            <div style="width: 100%; height: 50px;">
                <table style="width:30%; float:right">
                    <thead>
                        <tr>
                            <th
                            <% %>  style="font-size:<%= data.CustomerFont %> ; line-height:<%= data.CustomerLineSpace %>; border: 1px solid <%= data.Color %>; padding: 0px; margin:0px "> You've Saved <%=data.SavedDiscount%> Rs on this Invoice!
                        </th>
                        </tr>
                    </thead>
                </table>
            </div>
            <%}%>
            <%}%>
            <% if (data.company.ID === 93){%>
            <div style="width: 100%; height: 50px; margin-top: 10px;">
                <table style="width:30%; float:right">
                    <thead>
                        <tr>
                            <th
                            <% %>  style="font-size:<%= data.CustomerFont %> ; line-height:<%= data.CustomerLineSpace %>;border-top-style: dotted ;   border-top-color: <%= data.Color %>; padding: 0px; margin:0px "> Signature
                        </th>
                        </tr>
                    </thead>
                </table>
            </div>
            <%}%>
              <!-- You've Saved  end -->
            </section>
</body>

</html>