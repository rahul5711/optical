<section class="content">
    <div class="container-fluid">
        <div class="block-header"> </div>
        <div class="row clearfix">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 mt-0 ">
                <div class="card">
                    <div class="header">
                        <div class="row">
                            <div class="col-lg-2 col-md-2 col-3">
                                <h4 class="d-none d-md-block" style="font-weight: 600;"> Customer 
                                     <b style="color:#000">{{this.data.Category}}</b>
                                </h4>

                                <h4 class="d-block d-md-none" style="font-weight: 600;">  <b
                                        style="color:#000">{{this.data.Category}}</b>
                                </h4>
                            </div>

                        </div>
                    </div>
                    <div class="body">
                        <form #f="ngForm" autocomplete="off">
                            <div class="row">
                                <div class="col-xl-1 col-lg-2 col-md-3  col-4 mb-0">
                                    <mat-form-field class="example-full-width mb-0">
                                        <mat-label></mat-label>
                                        <mat-select name="Title" [(ngModel)]="data.Title" #Titlecontrol>
                                            <mat-option value=" "></mat-option>
                                            <mat-option value="MR.">Mr.</mat-option>
                                            <mat-option value="Mrs.">Mrs.</mat-option>
                                            <mat-option value="Miss.">Miss.</mat-option>
                                            <mat-option value="DR.">Dr.</mat-option>
                                            <mat-option value="ADV.">ADV.</mat-option>
                                            <mat-option value="Smt.">Smt.</mat-option>
                                            <mat-option value="Mst.">Mst.</mat-option>
                                            <mat-option value="Party">Party</mat-option>
                                            <mat-option value="M/S">M/S</mat-option>
                                        </mat-select>
                                    </mat-form-field>
                                </div>
                                <div class="col-xl-2 col-lg-2 col-md-3  col-8 mb-0">
                                    <mat-form-field class="example-full-width">
                                        <mat-label>Name</mat-label>
                                        <input type="text" aria-label="Text" matInput name="Name"
                                            [(ngModel)]="data.Name" (ngModelChange)="data.Name = onChange($event)"
                                            [formControl]="myControl" [matAutocomplete]="auto"
                                            (input)="customerSearch(myControl.value, 'Name')" required #nameInput>
                                        <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete"
                                            [panelWidth]="'370px'">
                                            <!-- <mat-option click=""> <i class="fa-solid fa-user-plus"></i>  Add Customer</mat-option> -->
                                            <mat-option style="border-bottom: 2px solid #000 !important;"
                                                class="customer-option" (click)="CustomerSelection('Value',option.ID)"
                                                *ngFor="let option of filteredOptions" [value]="option.Name">
                                                <table style="width:100%">
                                                    <thead>
                                                        <tr>
                                                            <td>{{option.Title}} {{option.Name | uppercase}}
                                                            </td>
                                                            <td style="text-align: right;">
                                                                {{option.MatchedMobile}}</td>
                                                        </tr>
                                                    </thead>
                                                </table>
                                            </mat-option>
                                        </mat-autocomplete>
                                        <mat-error>
                                            Name is required
                                        </mat-error>
                                    </mat-form-field>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-xl-5 col-lg-9 col-md-9 col-12 mb-0 mb-4 mb-md-0  ">
                                    <!-- <button *ngIf="id != 0" class="me-2 " mat-raised-button color="primary"
                                                style="padding: 5px 10px;"
                                                [routerLink]="['/sale/oldBilllist/',data.ID]"><span
                                                    class="first-letter">O</span>ld Bill
                                            </button> -->

                                    <button *ngIf="id != 0 " class="me-2" mat-raised-button color="primary"
                                        style="padding: 5px 10px; cursor: pointer;"
                                        [routerLink]="['/sale/billinglist/',data.ID]"><span
                                            class="first-letter">B</span>ill History</button>

                                    <button class=" me-2" (click)="clearFrom()" mat-raised-button color="primary"
                                        style="padding: 5px 22px ;cursor: pointer;">
                                        <span class="first-letter">C</span>lear
                                    </button>

                                    <button mat-raised-button color="primary" style="padding: 5px 22px"
                                        (click)="openModal(customer)">EXTRA</button>
                                </div>
                            </div>
                            <!--Customer Extra model popup start -->
                            <ng-template #customer role="document" let-modal>
                                <div class="modal-header" style="height: 50px; border-bottom: #ff651e 3px solid;">
                                    <div class="row" style="width:100%">
                                        <div class="col-4">
                                            <h2 class="modal-title header pt-2" id="exampleModalLabel">Customer Extra
                                                Fields </h2>
                                        </div>
                                        <div class="col-4">
                                            <h2 class="modal-title header pt-2" id="exampleModalLabel">Reward Balance <b
                                                    style="color:#000;">{{this.rewardBalance}}</b> </h2>
                                        </div>
                                        <div class="col-4">
                                            <h2 class="modal-title header pt-2" id="exampleModalLabel">Cust_Category <b
                                                    style="color:#000;">{{this.data.Category}}</b> </h2>
                                        </div>
                                    </div>

                                    <button type="button" title="Close Botton" class="btn-close" aria-hidden="true"
                                        (click)="modal.dismiss('Cross click')"></button>
                                </div>
                                <div class="modal-body">
                                    <div class="row mt-3 mt-md-0">
                                        <div class="col-md-10 col-12">
                                            <div class="row ">
                                                <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mb-0">
                                                    <mat-form-field class="example-full-width">
                                                        <mat-label>Mobile No</mat-label>
                                                        <input type="text" inputMode="numeric" aria-label="Text"
                                                            matInput name="MobileNo1" [(ngModel)]="data.MobileNo1"
                                                            [formControl]="myControl1" [matAutocomplete]="auto"
                                                            (input)="customerSearch(myControl1.value, 'MobileNo1')">
                                                        <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete"
                                                            [panelWidth]="'370px'">
                                                            <mat-option
                                                                style="border-bottom: 2px solid #000 !important;"
                                                                class="customer-option"
                                                                (click)="CustomerSelection('Value',option1.ID)"
                                                                *ngFor="let option1 of filteredOptions"
                                                                [value]="option1.MobileNo1">
                                                                <table style="width:100%">
                                                                    <thead>
                                                                        <tr>
                                                                            <td>{{option1.Name | uppercase}}</td>
                                                                            <td style="text-align: right;">
                                                                                {{option1.MobileNo1}}</td>
                                                                        </tr>
                                                                    </thead>
                                                                </table>
                                                            </mat-option>
                                                        </mat-autocomplete>
                                                    </mat-form-field>
                                                </div>
                                                <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mb-0">
                                                    <mat-form-field class="example-full-width mb-0">
                                                        <mat-label>Mobile No2</mat-label>
                                                        <input matInput type="number" name="MobileNo2"
                                                            [(ngModel)]="data.MobileNo2" #MobileNo2control />
                                                    </mat-form-field>
                                                </div>
                                                <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mb-0">
                                                    <mat-form-field class="example-full-width mb-0">
                                                        <mat-label>PhoneNo</mat-label>
                                                        <input matInput type="number" name="PhoneNo"
                                                            [(ngModel)]="data.PhoneNo" #PhoneNocontrol />
                                                        <mat-error>
                                                            Phone Number required
                                                        </mat-error>
                                                    </mat-form-field>
                                                </div>
                                                <div class="col-xl-3 col-lg-3 col-md-6 col-sm-12 col-12 mb-0">
                                                    <mat-form-field class="example-full-width mb-0">
                                                        <mat-label>Email</mat-label>
                                                        <input matInput name="Email" [(ngModel)]="data.Email"
                                                            pattern="^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$"
                                                            #Emailcontrol />
                                                        <mat-error>
                                                            Invalid EmailID
                                                        </mat-error>
                                                    </mat-form-field>
                                                </div>
                                                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-6 mb-0">
                                                    <mat-form-field class="example-full-width">
                                                        <mat-label>Address</mat-label>
                                                        <input type="text" aria-label="Text" matInput name="Address"
                                                            [(ngModel)]="data.Address"
                                                            (ngModelChange)="data.Address = onChange($event)"
                                                            [formControl]="myControl2" [matAutocomplete]="auto"
                                                            (input)="customerSearch(myControl2.value, 'Address')">
                                                        <mat-autocomplete autoActiveFirstOption2 #auto="matAutocomplete"
                                                            [panelWidth]="'370px'">
                                                            <mat-option
                                                                style="border-bottom: 2px solid #000 !important;"
                                                                class="customer-option"
                                                                (click)="CustomerSelection('Value',option2.ID)"
                                                                *ngFor="let option2 of filteredOptions"
                                                                [value]="option2.Address">
                                                                <table style="width:100%">
                                                                    <thead>
                                                                        <tr>
                                                                            <td>{{option2.Name | uppercase}}</td>
                                                                            <td style="text-align: right;">
                                                                                {{option2.Address}}
                                                                            </td>
                                                                        </tr>
                                                                    </thead>
                                                                </table>
                                                            </mat-option>
                                                        </mat-autocomplete>
                                                    </mat-form-field>
                                                </div>
                                                <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mb-0">
                                                    <mat-form-field class="example-full-width mb-0">
                                                        <mat-label>DOB</mat-label>
                                                        <input matInput name="DOB" type="date" [(ngModel)]="data.DOB"
                                                            (change)="calculateAge()">
                                                    </mat-form-field>
                                                </div>

                                                <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mb-0">
                                                    <mat-form-field class="example-full-width mb-0">
                                                        <mat-label>Age</mat-label>
                                                        <input matInput name="Age" type="number" min="0"
                                                            [(ngModel)]="data.Age">
                                                        <mat-error>
                                                            Invalid Value
                                                        </mat-error>
                                                    </mat-form-field>
                                                </div>
                                                <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mb-0">
                                                    <mat-form-field class="example-full-width mb-0">
                                                        <mat-label>Anniversary</mat-label>
                                                        <input matInput name="Anniversary" type="date"
                                                            [(ngModel)]="data.Anniversary">
                                                    </mat-form-field>
                                                </div>
                                                <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mb-0">
                                                    <mat-form-field class="example-full-width mb-0">
                                                        <mat-label>Gender </mat-label>
                                                        <mat-select name="Gender" [(ngModel)]="data.Gender"
                                                            #Gendercontrol>
                                                            <mat-option></mat-option>
                                                            <mat-option value="KIDS">KIDS</mat-option>
                                                            <mat-option value="MALE">MALE</mat-option>
                                                            <mat-option value="FEMALE">FEMALE</mat-option>
                                                            <mat-option value="TRANSGENDER">TRANSGENDER</mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </div>

                                                <!-- <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mb-0">
                                            <mat-form-field class="example-full-width mb-0">
                                                <mat-label>Reward Balance </mat-label>
                                                <input matInput name="rewardBalance" value="{{this.rewardBalance}}"
                                                    disabled style="color:red; font-weight:500" />
                                                <mat-error>
                                                    SR/MRD No. is required
                                                </mat-error>
                                            </mat-form-field>
                                        </div> -->
                                                <div class="col-xl-6 col-lg-6 col-md-6 col-sm-6 col-6 mb-0">
                                                    <mat-form-field class="example-full-width mb-0">
                                                        <mat-label>Remark/TLN </mat-label>
                                                        <textarea matInput name="Remarks" [(ngModel)]="data.Remarks"
                                                            (ngModelChange)="data.Remarks = onChange($event)"
                                                            #Remarkscontrol [style.height.px]="data.minHeight"
                                                            style="overflow-y: auto;"></textarea>
                                                        <mat-error>
                                                            Remarks is required
                                                        </mat-error>
                                                    </mat-form-field>
                                                </div>

                                                <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mb-0">
                                                    <mat-form-field class="example-full-width mb-0">
                                                        <mat-label>Reference Type </mat-label>
                                                        <mat-select name="ReferenceType"
                                                            [(ngModel)]="data.ReferenceType" #ReferenceTypecontrol>
                                                            <mat-option>
                                                                <ngx-mat-select-search matInput
                                                                    [(ngModel)]="searchValue"
                                                                    (ngModelChange)="searchValue = onChange($event)"
                                                                    [ngModelOptions]="{standalone: true}">
                                                                </ngx-mat-select-search>
                                                            </mat-option>
                                                            <mat-option [value]="r.Name"
                                                                *ngFor="let r of ReferenceList | nameFilterS: searchValue">
                                                                {{r.Name}}
                                                            </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </div>
                                                <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mb-0">
                                                    <mat-form-field class="example-full-width mb-0">
                                                        <mat-label>GST/VAT No</mat-label>
                                                        <input matInput name="GSTNo" [(ngModel)]="data.GSTNo"
                                                            (ngModelChange)="data.GSTNo = onChange($event)"
                                                            #GSTNocontrol />
                                                        <mat-error>
                                                            GST No is required
                                                        </mat-error>
                                                    </mat-form-field>
                                                </div>
                                                <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mb-0">
                                                    <mat-form-field class="example-full-width mb-0">
                                                        <mat-label> Other </mat-label>
                                                        <mat-select name="Other" [(ngModel)]="data.Other" #Othercontrol>
                                                            <mat-option>
                                                                <ngx-mat-select-search matInput
                                                                    [(ngModel)]="searchValue"
                                                                    (ngModelChange)="searchValue = onChange($event)"
                                                                    [ngModelOptions]="{standalone: true}">
                                                                </ngx-mat-select-search>
                                                            </mat-option>
                                                            <mat-option [value]="o.Name"
                                                                *ngFor="let o of otherLists | nameFilterS: searchValue">
                                                                {{o.Name}} </mat-option>
                                                        </mat-select>
                                                    </mat-form-field>
                                                </div>
                                                <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mb-0">
                                                    <mat-form-field class="example-full-width mb-0">
                                                        <mat-label>SR/MRD No. </mat-label>
                                                        <input matInput name="Sno" [(ngModel)]="data.Sno"
                                                            (input)="customerSearch(Snocontrol.value, 'Sno')"
                                                            #Snocontrol />
                                                        <mat-error>
                                                            SR/MRD No. is required
                                                        </mat-error>
                                                    </mat-form-field>
                                                </div>
                                                <div class="col-xl-3 col-lg-3 col-md-6 col-sm-6 col-6 mb-0">
                                                    <button *ngIf="id != 0" (click)="updateCustomer()"
                                                        [disabled]="!f.valid" mat-raised-button color="primary"
                                                        style="padding: 5px 18px; cursor: pointer;">up<span
                                                            class="first-letter">d</span>ate</button>
                                                    <button *ngIf="id == 0" (click)="onsubmit()"
                                                        [disabled]="!f.valid || data.Name == ''" mat-raised-button
                                                        color="primary" style="padding: 5px 22px; cursor: pointer;">
                                                        <span class="first-letter">S</span>ave
                                                    </button>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-md-2 col-12">
                                            <div *ngIf="company.PhotoClick == 'true'" class="row ">
                                                <div class="col-10 mt-md-0 ">
                                                    <img class="fit-picture" width="170" height="150"
                                                        [src]="customerImage">
                                                </div>
                                                <div class="col-xl-10 col-lg-10 col-md-10 col-11 mb-0 "
                                                    (click)="fileInput.click()" style="cursor: pointer;">
                                                    <i class="fa-solid fa-cloud-arrow-up upload_icon">
                                                        <span style="font-size: 10px;letter-spacing: 2px;">
                                                            Image
                                                        </span>
                                                    </i>
                                                    <input #fileInput id="my-input" name='PhotoURL' type="file"
                                                        (change)="uploadImage($event, 'User')" style="display:none;">
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-md-7 col-12 mt-4">
                                            <div class="row" *ngIf="company.PrimeMembership == 'true'">
                                                <div id="membershipCard" class="col-6"
                                                    style="background-image: linear-gradient(2deg, #ffc10731, #ffc10737),url(https://png.pngtree.com/thumb_back/fh260/background/20220428/pngtree-abstract-3d-elegant-golden-ribbon-elements-and-lighting-effect-sparking-glitter-image_1108708.jpg); border-radius: 4px; padding: 4px 15px;background-size: 100%; box-shadow: 0px 0px 3px 0px #7a672d;">
                                                    <div class="row pt-2" style="border-radius: 4px;">
                                                        <div class="col-12 ">
                                                            <h4 class="m-0"
                                                                style="font-weight: 800; color: #000000;text-shadow: 2px 2px 4px #bfbfbf; ">
                                                                {{this.data.Title}} {{this.data.Name}}</h4>

                                                            <h4 class="m-0"
                                                                style="font-weight: 800; color: #000000;text-shadow: 2px 2px 4px #bfbfbf; ">
                                                                {{this.data.MobileNo1}}</h4>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-12">
                                                            <h1 class="m-0 " style="font-weight: 800;
                                                                text-shadow: 2px 2px 2px #ffffff;
                                                                color: #7c6131;
                                                                letter-spacing: .8px;
                                                                font-size: 2rem;">Prime Membership</h1>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-12"
                                                            style="color: #7c6131; text-shadow: 2px 2px 3px #fff;">
                                                            <h4 style="font-weight: 800; margin:0">CARD NUMBER ****
                                                                **** *{{this.data.Idd}}</h4>
                                                        </div>
                                                        <div class="col-12 pt-1 pb-1">
                                                            <span
                                                                style="font-weight: 800; text-shadow: 2px 2px 4px #ffffff;">{{this.shop.Name}}</span>
                                                        </div>
                                                        <div class="col-6">
                                                            <span
                                                                style="font-weight: 800; text-shadow: 2px 2px 4px #ffffff;">{{this.shop.MobileNo1}}</span>
                                                        </div>
                                                        <div class="col-6" style="text-align: right;">
                                                            <span *ngIf="ActiveDeactive == true"
                                                                style="font-weight: 800; text-shadow: 2px 2px 4px #ffffff; font-size:10px; line-height: 9px; color:green;">Valid
                                                                {{this.ExpiryDateFormember}}</span>
                                                            <span *ngIf="ActiveDeactive == false"
                                                                style="font-weight: 800; text-shadow: 2px 2px 4px #ffffff; font-size:10px; line-height: 9px; color:red;">Expiry
                                                                {{this.ExpiryDateFormember}}</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-6">
                                                    <form #fmc="ngForm">
                                                        <div class="row">
                                                            <div class="col-xl-6 col-lg-6 col-md-6 col-12 mb-0">
                                                                <mat-form-field class="example-full-width mb-0">
                                                                    <mat-label>IssueDate</mat-label>
                                                                    <input matInput name="IssueDate" type="date"
                                                                        [(ngModel)]="memberCard.IssueDate" required
                                                                        autocomplete="false">
                                                                </mat-form-field>
                                                            </div>
                                                            <div class="col-xl-6 col-lg-6 col-md-6 col-12 mb-0">
                                                                <mat-form-field class="example-full-width mb-0">
                                                                    <mat-label>ExpiryDate</mat-label>
                                                                    <input matInput name="ExpiryDate" type="date"
                                                                        required [(ngModel)]="memberCard.ExpiryDate"
                                                                        autocomplete="false">
                                                                </mat-form-field>
                                                            </div>
                                                            <div class="col-6">
                                                                <button (click)="membarshipSave()" mat-raised-button
                                                                    type="submit" [disabled]="!fmc.valid"
                                                                    color="primary">Save
                                                                </button>
                                                                <button class="ms-1" (click)="shareOnWhatsApp()"
                                                                    mat-raised-button type="button" color="primary"
                                                                    [disabled]="this.membarshipList.length == 0"><i
                                                                        class="fa-brands fa-whatsapp "
                                                                        style="color:greenyellow"></i>
                                                                </button>
                                                            </div>
                                                            <div class="col-6">
                                                                <!-- <mat-slide-toggle name="Preorder" color="primary" 
                                                            class="example-margin"  [(ngModel)]="ActiveDeactive"  #Multiplecontrol style="color:#ff651e;">
                                                            Active/Deactive</mat-slide-toggle> -->
                                                            </div>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="col-md-5 col-12 mt-4">
                                            <div class="row ">
                                                <!-- <div class="col-md-7 col-12 p-0">
                                                        <textarea name="Remark" rows="5"
                                                            style="height: 100%; width:100%">
                                                            {{this.data.Remarks}}
                                                         </textarea>
                                                    </div> -->

                                                <div *ngIf="company.PrimeMembership == 'true'" class="col-12 " style="height: 150px;overflow: auto; border: 1px solid; padding: 0;
                                                    margin: 0px;">
                                                    <div class="table-responsive">
                                                        <table
                                                            class="table table-striped table-hover table-sm table-bordered"
                                                            style="border: 2px solid #fff !important;  ">
                                                            <thead>
                                                                <tr>
                                                                    <th>Action</th>
                                                                    <th>S.No</th>
                                                                    <th>IssueDate</th>
                                                                    <th>ExpiryDate</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <tr class="text-center"
                                                                    *ngFor="let data of membarshipList let i = index;"
                                                                    style="white-space: nowrap;">
                                                                    <td style="width: 5%;">
                                                                        <button type="button" class="bg-btn"
                                                                            (click)="MembershipcardBydelete(data.ID)">
                                                                            <mat-icon
                                                                                class="delete_iconms ms-1">delete_forever</mat-icon>
                                                                        </button>
                                                                    </td>
                                                                    <td>{{membarshipList.length - i }}</td>
                                                                    <td>{{dateFormat(data.IssueDate)}}</td>
                                                                    <td>{{dateFormat(data.ExpiryDate)}}</td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </ng-template>
                            <!--Customer Extra model popup end -->
                        </form>
                    </div>
                </div>

                <!-- bill info -->
                <div *ngIf="this.Link != true">
                    <div *ngIf="this.CustomerBillView == true">
                        <app-bill @fade [customerID2]="this.id"></app-bill>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>