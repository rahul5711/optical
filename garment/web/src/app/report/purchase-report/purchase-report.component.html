<section class="content">
  <div class="container-fluid">
    <div class="block-header">
      <div class="row clearfix">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 mt-0">
          <div class="card p-0">
            <div class="header p-2 py-0 pt-1">
              <div class="row">
                <div class="col-md-2 col-8 p-0 ms-3">
                  <h2>Purchase Report </h2>
                </div>
              </div>
            </div>
            <mat-tab-group>
              <!-- Purchase  -->
              <mat-tab *ngIf="viewPurchaseReport" label="Purchase">
                <div class="body">
                  <form class="p-3 pb-0" #f1="ngForm" (ngSubmit)="getPurchaseMaster()">
                    <div class="row" >
                      <div class="col-xl-2 col-lg-2 col-md-4 col-6 mb-0 ">
                        <mat-form-field class="example-full-width mb-0">
                          <mat-label>From</mat-label>
                          <input matInput name="FromDate" type="date" [(ngModel)]="PurchaseMaster.FromDate" #DOBcontrol
                            [disabled]="!editPurchaseReport" />
                        </mat-form-field>
                      </div>
                      <div class="col-xl-2 col-lg-2 col-md-4 col-6 mb-0 ">
                        <mat-form-field class="example-full-width mb-0">
                          <mat-label>To</mat-label>
                          <input matInput type="date" name="ToDate" [(ngModel)]="PurchaseMaster.ToDate"
                            [disabled]="!editPurchaseReport" />
                        </mat-form-field>
                      </div>
                      <div class="col-xl-2 col-lg-2 col-md-4 col-6 mb-0 ">
                        <!-- <mat-form-field class="example-full-width mb-0">
                          <mat-label>Supplier Name</mat-label>
                          <mat-select name="Supplier" [(ngModel)]="PurchaseMaster.SupplierID" editable="true"
                            #singleSelect>
                            <mat-option [value]="0">All</mat-option>
                            <mat-option *ngFor="let sup of supplierList  let i = index;" [value]="sup.ID">
                              {{sup.Name}}<span style="float: right;">{{sup.MobileNo1}}
                              </span>
                            </mat-option>
                          </mat-select>
                          <mat-error>
                            Select Supplier
                          </mat-error>
                        </mat-form-field> -->
                        <mat-form-field class="example-full-width">
                          <mat-label>Supplier Name</mat-label>
                          <input type="text" placeholder="serach customer" aria-label="Text" matInput
                          name="SupplierID"  [formControl]="myControl" [matAutocomplete]="auto"
                                 (input)="customerSearch(myControl.value, 'Name','Supplier')">
                          <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete" >
                            <mat-option (click)="CustomerSelection('All','0')" value='All'>All</mat-option>
                            <mat-option (click)="CustomerSelection('PurchaseMaster',option.ID)" *ngFor="let option of filteredOptions" [value]="option.Name">
                              {{option.Name}} {{option.MobileNo1}}
                            </mat-option>
                          </mat-autocomplete>
                        </mat-form-field>
                      </div>
                      <div class="col-xl-2 col-lg-2 col-md-4 col-6 mb-0 ">
                        <mat-form-field class="example-full-width mb-0" *ngIf="user.UserGroup === 'CompanyAdmin'">
                          <mat-label>Shop Name</mat-label>
                          <mat-select name="shopID" [(ngModel)]="PurchaseMaster.ShopID" multiple>
                            <mat-option [value]=0>All</mat-option>
                            <mat-option [value]="s.ID" *ngFor="let s of shopList"> {{s.Name}}
                              <span [style.color]="'blue'" *ngIf="s.AreaName !== 'null'">({{s.AreaName}})</span>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                        <mat-form-field class="example-full-width mb-0" *ngIf="user.UserGroup !== 'CompanyAdmin'">
                          <mat-label>Shop Name</mat-label>
                          <mat-select name="shopID" [(ngModel)]="PurchaseMaster.ShopID" >
                            <mat-option [value]="s.ID" *ngFor="let s of shopList"> {{s.Name}}
                              <span [style.color]="'blue'" *ngIf="s.AreaName !== 'null'">({{s.AreaName}})</span>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </div>
                      <div class="col-xl-2 col-lg-2 col-md-4 col-6 mb-0 ">
                        <mat-form-field class="example-full-width mb-0">
                          <mat-label>Payment Status</mat-label>
                          <mat-select name="PaymentStatus" [(ngModel)]="PurchaseMaster.PaymentStatus">
                            <mat-option [value]="0">All</mat-option>
                            <mat-option value="Paid">Paid</mat-option>
                            <mat-option value="Unpaid">Unpaid</mat-option>
                          </mat-select>
                        </mat-form-field>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6 col-12 mb-0 ">
                        <button type="submit" class="me-2" mat-raised-button color="primary">
                          Search
                        </button>
                        <button type="button" class="me-2" mat-raised-button color="primary"
                          (click)="getPurchaseMasterExport()">
                          Quick Download
                        </button>
                        <button type="button" mat-raised-button color="warn"
                          (click)="purchaseFromReset()">
                          Reset
                        </button>
                      </div>
                    </div>
                  </form>
                  <!-- Purchase list -->
                  <div class="body p-2">
                    <div id="Purchase-content" class="col-sm-12" style="overflow: auto; height: 450px;">
                      <table class="table table-striped table-hover table-sm table-bordered"
                        style="border: 2px solid #fff !important;" id="purchaseExcel">
                        <thead>
                          <tr style="white-space: nowrap;">
                            <th>S.No</th>
                            <th *ngIf="columnVisibility.Supplier"       >Supplier</th>
                            <th *ngIf="columnVisibility.CurrentShop"    >CurrentShop</th>
                            <th *ngIf="columnVisibility.InvoiceNo"      >InvoiceNo</th>
                            <th *ngIf="columnVisibility.InvoiceDate"    >InvoiceDate</th>
                            <th *ngIf="columnVisibility.PaymentStatus"  >PaymentStatus</th>
                            <th *ngIf="columnVisibility.Quantity"       >Quantity</th>
                            <th *ngIf="columnVisibility.Discount"       >Discount </th>
                            <th *ngIf="columnVisibility.SubTotal"       >SubTotal</th>
                            <th *ngIf="columnVisibility.TAXAmount"      >TAXAmount </th>
                            <th *ngIf="columnVisibility.IGST"           >IGST</th>
                            <th *ngIf="columnVisibility.SGST"           >SGST</th>
                            <th *ngIf="columnVisibility.CGST"           >CGST</th>
                            <th *ngIf="columnVisibility.GrandTotal"     >GrandTotal</th>
                            <th *ngIf="columnVisibility.SupplierTAXNo"  >SupplierTAXNo</th>
                          </tr>
                          <tr class="totolRow" *ngIf="this.totalQty != null && this.totalQty != '' ">
                            <td>
                              <i class="fa fa-file-excel-o excel" title="ExportAsXLSX" aria-hidden="true" type="button"
                                (click)="exportAsXLSXMaster()">
                              </i>
                              <button class="bg_none ms-4" (click)="print('Purchase-content')" >
                                <i class="far fa-file-pdf "
                                    style="color: #1a1e90;font-size: 22px;cursor: pointer;"> </i>
                            </button>
                            <div class="button-container">
                              <button class="bg_none">
                                  <i class="fa-solid fa-filter" style="font-size: 20px; color: #f44336;"></i>
                              </button>
                              <div class="hover-box">

                                  <button (click)="toggleColumnVisibility('Supplier')">
                                      <mat-checkbox class="me-2" name="Supplier" [(ngModel)]="columnVisibility.Supplier"></mat-checkbox>
                                       Supplier
                                  </button>
                                  <button (click)="toggleColumnVisibility('CurrentShop')">
                                      <mat-checkbox class="me-2" name="CurrentShop" [(ngModel)]="columnVisibility.CurrentShop"></mat-checkbox>
                                       CurrentShop
                                  </button>
                                  <button (click)="toggleColumnVisibility('InvoiceNo')">
                                      <mat-checkbox class="me-2" name="InvoiceNo" [(ngModel)]="columnVisibility.InvoiceNo"></mat-checkbox>
                                       InvoiceNo
                                  </button>
                                  <button (click)="toggleColumnVisibility('InvoiceDate')">
                                      <mat-checkbox class="me-2" name="InvoiceDate" [(ngModel)]="columnVisibility.InvoiceDate"></mat-checkbox>
                                       InvoiceDate
                                  </button>
                                  <button (click)="toggleColumnVisibility('PaymentStatus')">
                                      <mat-checkbox class="me-2" name="PaymentStatus" [(ngModel)]="columnVisibility.PaymentStatus"></mat-checkbox>
                                       PaymentStatus
                                  </button>
                                  <button (click)="toggleColumnVisibility('Quantity')">
                                      <mat-checkbox class="me-2" name="Quantity" [(ngModel)]="columnVisibility.Quantity"></mat-checkbox>
                                       Quantity
                                  </button>
                                  <button (click)="toggleColumnVisibility('Discount')">
                                      <mat-checkbox class="me-2" name="Discount" [(ngModel)]="columnVisibility.Discount"></mat-checkbox>
                                       Discount
                                  </button>
                                  <button (click)="toggleColumnVisibility('SubTotal')">
                                      <mat-checkbox class="me-2" name="SubTotal" [(ngModel)]="columnVisibility.SubTotal"></mat-checkbox>
                                       SubTotal
                                  </button>
                                  <button (click)="toggleColumnVisibility('TAXAmount')">
                                      <mat-checkbox class="me-2" name="TAXAmount" [(ngModel)]="columnVisibility.TAXAmount"></mat-checkbox>
                                       TAXAmount
                                  </button>
                                  <button (click)="toggleColumnVisibility('IGST')">
                                      <mat-checkbox class="me-2" name="IGST" [(ngModel)]="columnVisibility.IGST"></mat-checkbox>
                                       IGST
                                  </button>
                                  <button (click)="toggleColumnVisibility('SGST')">
                                      <mat-checkbox class="me-2" name="SGST" [(ngModel)]="columnVisibility.SGST"></mat-checkbox>
                                       SGST
                                  </button>
                                  <button (click)="toggleColumnVisibility('CGST')">
                                      <mat-checkbox class="me-2" name="CGST" [(ngModel)]="columnVisibility.CGST"></mat-checkbox>
                                       CGST
                                  </button>
                                  <button (click)="toggleColumnVisibility('GrandTotal')">
                                      <mat-checkbox class="me-2" name="GrandTotal" [(ngModel)]="columnVisibility.GrandTotal"></mat-checkbox>
                                       GrandTotal
                                  </button>
                                  <button (click)="toggleColumnVisibility('SupplierTAXNo')">
                                      <mat-checkbox class="me-2" name="SupplierTAXNo" [(ngModel)]="columnVisibility.SupplierTAXNo"></mat-checkbox>
                                       SupplierTAXNo
                                  </button>
                              </div>
                          </div>
                            </td>
                            <td *ngIf="columnVisibility.Supplier"       ></td>
                            <td *ngIf="columnVisibility.CurrentShop"    ></td>
                            <td *ngIf="columnVisibility.InvoiceNo"      ></td>
                            <td *ngIf="columnVisibility.InvoiceDate"    ></td>
                            <td *ngIf="columnVisibility.PaymentStatus"  ></td>
                            <td *ngIf="columnVisibility.Quantity"       >{{this.totalQty}}</td>
                            <td *ngIf="columnVisibility.Discount"       >{{this.totalDiscount}}</td>
                            <td *ngIf="columnVisibility.SubTotal"       >{{this.totalUnitPrice}}</td>
                            <td *ngIf="columnVisibility.TAXAmount"       (click)="openModal3(content3)">{{this.totalGstAmount}}</td>
                            <td *ngIf="columnVisibility.IGST"           ></td>
                            <td *ngIf="columnVisibility.SGST"           ></td>
                            <td *ngIf="columnVisibility.CGST"           ></td>
                            <td *ngIf="columnVisibility.GrandTotal"     >{{this.totalAmount}}</td>
                            <td *ngIf="columnVisibility.SupplierTAXNo"  ></td>
                          </tr>
                        </thead>
                        <tbody class="text-center">
                          <tr *ngFor="let m of PurchaseMasterList; let i = index" text="left">
                            <td> {{ i+1 }} </td>
                            <td *ngIf="columnVisibility.Supplier"       >{{m.SupplierName}}</td>
                            <td *ngIf="columnVisibility.CurrentShop"    >{{m.ShopName}} <span [style.color]="'blue'" *ngIf="m.AreaName !== 'null'">({{m.AreaName}})</span></td>
                            <td *ngIf="columnVisibility.InvoiceNo"      >{{m.InvoiceNo}}</td>
                            <td *ngIf="columnVisibility.InvoiceDate"    >{{dateFormat(m.PurchaseDate)}}</td>
                            <td *ngIf="columnVisibility.PaymentStatus"  >{{m.PaymentStatus}}</td>
                            <td *ngIf="columnVisibility.Quantity"       >{{m.Quantity}}</td>
                            <td *ngIf="columnVisibility.Discount"       >{{m.DiscountAmount }} </td>
                            <td *ngIf="columnVisibility.SubTotal"       >{{m.SubTotal }}</td>
                            <td *ngIf="columnVisibility.TAXAmount"      >{{m.GSTAmount }} </td>
                            <td *ngIf="columnVisibility.IGST && m.gst_detailssss[0][0].type === 'iGST'">{{m.gst_detailssss[0][0].amt.toFixed(2)}}</td>
                            <td *ngIf="columnVisibility.SGST && m.gst_detailssss[0][1].type === 'cGST-sGST'">{{(m.gst_detailssss[0][1].amt/2).toFixed(2) }}</td>
                            <td *ngIf="columnVisibility.CGST && m.gst_detailssss[0][1].type === 'cGST-sGST'">{{(m.gst_detailssss[0][1].amt/2).toFixed(2) }}</td>
                            <td *ngIf="columnVisibility.GrandTotal"     >{{m.TotalAmount }}</td>
                            <td *ngIf="columnVisibility.SupplierTAXNo"  >{{m.SupplierGSTNo}}</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </mat-tab>
              <!-- Purchase (Detailed) -->
              <mat-tab *ngIf="viewPurchaseProductReport" label="Purchase (Product Type)">
                <div class="body">
                  <form class="p-3 pb-0" #f2="ngForm" (ngSubmit)="getPurchaseDetails()">
                    <div class="row" >
                      <div class="col-xl-2 col-lg-2 col-md-4 col-6 mb-0 ">
                        <mat-form-field class="example-full-width mb-0">
                          <mat-label>From</mat-label>
                          <input matInput name="FromDateD" type="date" [(ngModel)]="PurchaseDetail.FromDate" #DOBcontrol
                            [disabled]="!editPurchaseProductReport" />
                        </mat-form-field>
                      </div>
                      <div class="col-xl-2 col-lg-2 col-md-4 col-6 mb-0 ">
                        <mat-form-field class="example-full-width mb-0">
                          <mat-label>To</mat-label>
                          <input matInput type="date" name="ToDateD" [(ngModel)]="PurchaseDetail.ToDate"
                            [disabled]="!editPurchaseProductReport" />
                        </mat-form-field>
                      </div>
                      <div class="col-xl-2 col-lg-2 col-md-4 col-6 mb-0 ">
                        <!-- <mat-form-field class="example-full-width mb-0">
                          <mat-label>Supplier Name</mat-label>
                          <mat-select name="Supplier" [(ngModel)]="PurchaseDetail.SupplierID" editable="true"
                            #singleSelect>
                            <mat-option [value]="0">All</mat-option>
                            <mat-option *ngFor="let sup of supplierList  let i = index;" [value]="sup.ID">
                              {{sup.Name}}<span style="float: right;">{{sup.MobileNo1}}
                              </span>
                            </mat-option>
                          </mat-select>
                          <mat-error>
                            Select Supplier
                          </mat-error>
                        </mat-form-field> -->
                        <mat-form-field class="example-full-width">
                          <mat-label>Supplier Name</mat-label>
                          <input type="text" placeholder="serach customer" aria-label="Text" matInput
                          name="SupplierID"  [formControl]="myControl" [matAutocomplete]="auto1"
                                 (input)="customerSearch(myControl.value, 'Name','Supplier')">
                          <mat-autocomplete autoActiveFirstOption #auto1="matAutocomplete" >
                            <mat-option (click)="CustomerSelection('All','0')" value='All'>All</mat-option>
                            <mat-option (click)="CustomerSelection('PurchaseDetail',option.ID)" *ngFor="let option of filteredOptions" [value]="option.Name">
                              {{option.Name}} {{option.MobileNo1}}
                            </mat-option>
                          </mat-autocomplete>
                        </mat-form-field>
                      </div>
                      <div class="col-xl-2 col-lg-2 col-md-4 col-6 mb-0 ">
                        <mat-form-field class="example-full-width mb-0" *ngIf="user.UserGroup === 'CompanyAdmin'">
                          <mat-label>Shop Name</mat-label>
                          <mat-select name="shopID" [(ngModel)]="PurchaseDetail.ShopID" multiple>
                            <mat-option [value]=0>All</mat-option>
                            <mat-option [value]="s.ID" *ngFor="let s of shopList"> {{s.Name}}
                              <span [style.color]="'blue'" *ngIf="s.AreaName !== 'null'">({{s.AreaName}})</span>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                        <mat-form-field class="example-full-width mb-0" *ngIf="user.UserGroup !== 'CompanyAdmin'">
                          <mat-label>Shop Name</mat-label>
                          <mat-select name="shopID" [(ngModel)]="PurchaseDetail.ShopID">
                            <mat-option [value]="s.ID" *ngFor="let s of shopList"> {{s.Name}}
                              <span [style.color]="'blue'" *ngIf="s.AreaName !== 'null'">({{s.AreaName}})</span>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </div>
                      <div class="col-xl-2 col-lg-2 col-md-4 col-6 mb-0">
                        <mat-form-field class="example-full-width mb-0">
                          <mat-label>Product search</mat-label>
                          <input matInput name="Productsearch" [(ngModel)]="Productsearch" #Productsearchcontrol>
                          <mat-error>
                            Productsearch required
                          </mat-error>
                        </mat-form-field>
                      </div>
                      <div class="col-xl-2 col-lg-2 col-md-4 col-6 mb-0">
                        <mat-form-field class="example-full-width mb-0">
                          <mat-label>Select Product</mat-label>
                          <mat-select name="FieldType" [(ngModel)]="PurchaseDetail.ProductCategory"
                            (selectionChange)="getFieldList()" required #Typecontrol>
                            <mat-option>
                              <ngx-mat-select-search matInput [(ngModel)]="searchValue" (ngModelChange)="searchValue = onChange($event)" [ngModelOptions]="{standalone: true}">
                              </ngx-mat-select-search>
                          </mat-option>
                            <mat-option [value]=0>All</mat-option>
                            <mat-option *ngFor="let prod of prodList | prodtypename: searchValue   let i = index;" [value]="prod.ID">
                              {{prod.Name | uppercase}}
                            </mat-option>
                          </mat-select>
                          <mat-error>
                            Select Product Type
                          </mat-error>
                        </mat-form-field>
                      </div>
                      <!-- spec start -->
                      <div class="col-xl-2 col-lg-2 col-md-4 col-6 mb-0"
                        *ngFor="let spec of specList ; let i = index;">
                        <div *ngIf="spec.FieldType === 'DropDown'" class="d-flex">
                          <mat-form-field class=" me-2 mb-0" *ngIf="spec.DisplayAdd === 0">
                            <mat-label>{{spec.FieldName}}</mat-label>
                            <mat-select name="{{spec.FieldName+'0'}}" [(ngModel)]="spec.SelectedValue"
                              (selectionChange)="getFieldSupportData(i)" editable="true"
                              [required]="spec.Required === 1" #singleSelect>
                              <mat-option>
                                <ngx-mat-select-search matInput [(ngModel)]="spec.EnteredValue" (ngModelChange)="spec.EnteredValue = onChange($event)" [ngModelOptions]="{standalone: true}">
                                </ngx-mat-select-search>
                            </mat-option>
                              <mat-option>
                              </mat-option>
                              <mat-option *ngFor="let val of spec.SptFilterData| productitemfilter: spec.EnteredValue" [value]="val.TableValue">
                                {{val.TableValue}}
                              </mat-option>
                            </mat-select>
                            <mat-error>
                              {{spec.FieldName}} is Required
                            </mat-error>
                          </mat-form-field>
                        </div>
                        <div *ngIf="spec.FieldType === 'Text'" class="d-flex">
                          <mat-form-field class=" mr-0 mb-0">
                            <mat-label>{{spec.FieldName}}</mat-label>
                            <input matInput name="{{spec.FieldName+'2'}}" [(ngModel)]="spec.SelectedValue"
                              [required]="spec.Required === 1" (blur)="getFieldSupportData(i)">
                            <mat-error>
                              {{spec.FieldName}} is Required
                            </mat-error>
                          </mat-form-field>
                        </div>
                        <div *ngIf="spec.FieldType === 'Date'" class="d-flex">
                          <mat-form-field class=" mr-0 mb-0">
                            <mat-label>{{spec.FieldName}}</mat-label>
                            <input type="date" matInput name="{{spec.FieldName+'3'}}" [(ngModel)]="spec.SelectedValue"
                              editable="true" [required]="spec.Required === 1">
                            <mat-error>
                              {{spec.FieldName}} is Required
                            </mat-error>
                          </mat-form-field>
                        </div>
                        <div *ngIf="spec.FieldType === 'boolean'" class="d-flex">
                          <mat-slide-toggle name="{{spec.FieldName+'3'}}" color="primary" class="example-margin"
                            #Multiplecontrolx [(ngModel)]="spec.SelectedValue">
                            {{spec.FieldName}}</mat-slide-toggle>
                        </div>
                      </div>
                      <!--  spec end -->
                      <div class="col-xl-2 col-lg-2 col-md-4 col-6 mb-0">
                        <mat-form-field class="example-full-width mb-0">
                          <mat-label>TAX Type</mat-label>
                          <mat-select name="GSTType" [(ngModel)]="PurchaseDetail.GSTType" #singleSelect>
                            <mat-option [value]="0">All</mat-option>
                            <mat-option [value]="g.Name" *ngFor="let g of gstList">{{g.Name}}
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </div>
                      <div class="col-xl-2 col-lg-2 col-md-4 col-6 mb-0">
                        <mat-form-field class="example-full-width mb-0">
                          <mat-label>TAX Percentage</mat-label>
                          <mat-select name="GSTPercentage" [(ngModel)]="PurchaseDetail.GSTPercentage">
                            <mat-option [value]="0">All</mat-option>
                            <mat-option value="12">12%</mat-option>
                            <mat-option value="18">18%</mat-option>
                          </mat-select>
                        </mat-form-field>
                      </div>
                      <div class="col-xl-4 col-lg-4 col-md-6 col-12 mb-0 ">
                        <button class="me-2" type="submit" mat-raised-button color="primary">
                          Search
                        </button>
                        <button type="button" class="me-2" mat-raised-button color="warn" (click)="purchaseDetailsFromReset()">
                          Reset
                        </button>
                        <button type="button" class="me-2 " mat-raised-button color="primary" (click)="getPurchaseDetailsExport()">
                          Quick Download
                        </button>
                        <span *ngIf="this.selectedProduct == 'LENS'">
                          <button *ngIf="company.ID == 241 || company.ID == 300 "  type="button"   (click)="openModalS(content00)" mat-raised-button color="primary" [disabled]="PurchaseDetailList.length == 0">Base Grid</button>
                      </span>
                        <span *ngIf="this.selectedProduct == 'LENS SEMI-FINISHED'">
                          <button *ngIf="company.ID == 241 || company.ID == 300 "  type="button"   (click)="openModalS1(content01)" mat-raised-button color="primary" [disabled]="PurchaseDetailList.length == 0">Semi-Finished</button>
                      </span>
                      </div>
                   
                    </div>
                  </form>
                  <!-- Purchase Detailed list -->
                  <div class="body p-2">
                    <div id="PurchaseDetail-content" class="col-sm-12" style="overflow: auto; height: 450px;">
                      <table class="table table-striped table-hover table-sm table-bordered"
                        style="border: 2px solid #fff !important;" id="purchaseDetailExcel">
                        <thead>
                          <tr style="white-space: nowrap;">
                            <th>S.No </th>
                            <th *ngIf="columnVisibility1.InvoiceNo"            >InvoiceNo</th>
                            <th *ngIf="columnVisibility1.InvoiceDate"          >InvoiceDate</th>
                            <th *ngIf="columnVisibility1.Supplier"             >Supplier</th>
                            <th *ngIf="columnVisibility1.TAXNo"                >TAXNo</th>
                            <th *ngIf="columnVisibility1.ProductType"          >ProductType</th>
                            <th *ngIf="columnVisibility1.HSNCode"              >HSNCode</th>
                            <th *ngIf="columnVisibility1.Product"              >Product</th>
                            <th *ngIf="columnVisibility1.Qty"                  >Qty</th>
                            <th *ngIf="columnVisibility1.UnitPrice"            >UnitPrice</th>
                            <th *ngIf="columnVisibility1.Dis"                  >Dis</th>
                            <th *ngIf="columnVisibility1.SubTotal"             >SubTotal <span style="font-size: 8px;">(PriceBeforeTax)</span> </th>
                            <th *ngIf="columnVisibility1.TAXType"              >TAXType</th>
                            <th *ngIf="columnVisibility1.TAX"                  >TAX%</th>
                            <th *ngIf="columnVisibility1.TAXAmt"               >TAXAmt</th>
                            <th                                               style="display: none;"> CGST%</th>
                            <th                                               style="display: none;"> CGSTAmt</th>
                            <th                                               style="display: none;"> SGST%</th>
                            <th                                               style="display: none;"> SGSTAmt</th>
                            <th                                               style="display: none;"> IGST%</th>
                            <th                                               style="display: none;"> IGSTAmt</th>
                            <th *ngIf="columnVisibility1.GrandTotal"           >GrandTotal</th>
                            <th *ngIf="columnVisibility1.BarCode"              >BarCode</th>
                            <th *ngIf="columnVisibility1.PaymentStatus"        >PaymentStatus</th>
                            <th *ngIf="columnVisibility1.RetailPer_PcPrice"    >RetailPer_PcPrice</th>
                            <th *ngIf="columnVisibility1.RetailTotalPrice"     >RetailTotalPrice</th>
                            <th *ngIf="columnVisibility1.WholeSalePer_PcPrice" >WholeSalePer_PcPrice</th>
                            <th *ngIf="columnVisibility1.WholeSaleTotalPrice"  >WholeSaleTotalPrice</th>
                            <th *ngIf="columnVisibility1.CurrentShop"          >CurrentShop</th>
                          </tr>
                          <tr class="totolRow" *ngIf="this.DetailtotalQty != null && this.DetailtotalQty != '' ">
                            <td style="white-space: nowrap;">
                              <i class="fa fa-file-excel-o excel" title="ExportAsXLSX" aria-hidden="true" type="button"
                                (click)="exportAsXLSXDetail()">
                              </i>
                              <button class="bg_none ms-4 me-2" (click)="print('PurchaseDetail-content')" >
                                <i class="far fa-file-pdf "
                                    style="color: #1a1e90;font-size: 22px;cursor: pointer;"> </i>
                            </button>
                            <div class="button-container">
                              <button class="bg_none">
                                  <i class="fa-solid fa-filter" style="font-size: 20px; color: #f44336;"></i>
                              </button>
                              <div class="hover-box">

                                  <button (click)="toggleColumnVisibility1('InvoiceNo')">
                                      <mat-checkbox class="me-2" name="InvoiceNo" [(ngModel)]="columnVisibility1.InvoiceNo"></mat-checkbox>
                                       InvoiceNo
                                  </button>
                                  <button (click)="toggleColumnVisibility1('InvoiceDate')">
                                      <mat-checkbox class="me-2" name="InvoiceDate" [(ngModel)]="columnVisibility1.InvoiceDate"></mat-checkbox>
                                       InvoiceDate
                                  </button>
                                  <button (click)="toggleColumnVisibility1('Supplier')">
                                      <mat-checkbox class="me-2" name="Supplier" [(ngModel)]="columnVisibility1.Supplier"></mat-checkbox>
                                       Supplier
                                  </button>
                                  <button (click)="toggleColumnVisibility1('TAXNo')">
                                      <mat-checkbox class="me-2" name="TAXNo" [(ngModel)]="columnVisibility1.TAXNo"></mat-checkbox>
                                       TAXNo
                                  </button>
                                  <button (click)="toggleColumnVisibility1('ProductType')">
                                      <mat-checkbox class="me-2" name="ProductType" [(ngModel)]="columnVisibility1.ProductType"></mat-checkbox>
                                       ProductType
                                  </button>
                                  <button (click)="toggleColumnVisibility1('HSNCode')">
                                      <mat-checkbox class="me-2" name="HSNCode" [(ngModel)]="columnVisibility1.HSNCode"></mat-checkbox>
                                       HSNCode
                                  </button>
                                  <button (click)="toggleColumnVisibility1('Product')">
                                      <mat-checkbox class="me-2" name="Product" [(ngModel)]="columnVisibility1.Product"></mat-checkbox>
                                       Product
                                  </button>
                                  <button (click)="toggleColumnVisibility1('Qty')">
                                      <mat-checkbox class="me-2" name="Qty" [(ngModel)]="columnVisibility1.Qty"></mat-checkbox>
                                       Qty
                                  </button>
                                  <button (click)="toggleColumnVisibility1('UnitPrice')">
                                      <mat-checkbox class="me-2" name="UnitPrice" [(ngModel)]="columnVisibility1.UnitPrice"></mat-checkbox>
                                       UnitPrice
                                  </button>
                                  <button (click)="toggleColumnVisibility1('Dis')">
                                      <mat-checkbox class="me-2" name="Dis" [(ngModel)]="columnVisibility1.Dis"></mat-checkbox>
                                       Dis
                                  </button>
                                  <button (click)="toggleColumnVisibility1('SubTotal')">
                                      <mat-checkbox class="me-2" name="SubTotal" [(ngModel)]="columnVisibility1.SubTotal"></mat-checkbox>
                                       SubTotal
                                  </button>
                                  <button (click)="toggleColumnVisibility1('TAXType')">
                                      <mat-checkbox class="me-2" name="TAXType" [(ngModel)]="columnVisibility1.TAXType"></mat-checkbox>
                                       TAXType
                                  </button>
                                  <button (click)="toggleColumnVisibility1('TAX')">
                                      <mat-checkbox class="me-2" name="TAX" [(ngModel)]="columnVisibility1.TAX"></mat-checkbox>
                                       TAX
                                  </button>
                                  <button (click)="toggleColumnVisibility1('TAXAmt')">
                                      <mat-checkbox class="me-2" name="TAXAmt" [(ngModel)]="columnVisibility1.TAXAmt"></mat-checkbox>
                                       TAXAmt
                                  </button>
                                  <button (click)="toggleColumnVisibility1('GrandTotal')">
                                      <mat-checkbox class="me-2" name="GrandTotal" [(ngModel)]="columnVisibility1.GrandTotal"></mat-checkbox>
                                       GrandTotal
                                  </button>
                                  <button (click)="toggleColumnVisibility1('BarCode')">
                                      <mat-checkbox class="me-2" name="BarCode" [(ngModel)]="columnVisibility1.BarCode"></mat-checkbox>
                                       BarCode
                                  </button>
                                  <button (click)="toggleColumnVisibility1('PaymentStatus')">
                                      <mat-checkbox class="me-2" name="PaymentStatus" [(ngModel)]="columnVisibility1.PaymentStatus"></mat-checkbox>
                                       PaymentStatus
                                  </button>
                                  <button (click)="toggleColumnVisibility1('RetailPer_PcPrice')">
                                      <mat-checkbox class="me-2" name="RetailPer_PcPrice" [(ngModel)]="columnVisibility1.RetailPer_PcPrice"></mat-checkbox>
                                       RetailPer_PcPrice
                                  </button>
                                  <button (click)="toggleColumnVisibility1('RetailTotalPrice')">
                                      <mat-checkbox class="me-2" name="RetailTotalPrice" [(ngModel)]="columnVisibility1.RetailTotalPrice"></mat-checkbox>
                                       RetailTotalPrice
                                  </button>
                                  <button (click)="toggleColumnVisibility1('WholeSalePer_PcPrice')">
                                      <mat-checkbox class="me-2" name="WholeSalePer_PcPrice" [(ngModel)]="columnVisibility1.WholeSalePer_PcPrice"></mat-checkbox>
                                       WholeSalePer_PcPrice
                                  </button>
                                  <button (click)="toggleColumnVisibility1('WholeSaleTotalPrice')">
                                      <mat-checkbox class="me-2" name="WholeSaleTotalPrice" [(ngModel)]="columnVisibility1.WholeSaleTotalPrice"></mat-checkbox>
                                       WholeSaleTotalPrice
                                  </button>
                                  <button (click)="toggleColumnVisibility1('CurrentShop')">
                                      <mat-checkbox class="me-2" name="CurrentShop" [(ngModel)]="columnVisibility1.CurrentShop"></mat-checkbox>
                                       CurrentShop
                                  </button>
                              </div>
                          </div>
                            </td>
                            <td *ngIf="columnVisibility1.InvoiceNo"           ></td>
                            <td *ngIf="columnVisibility1.InvoiceDate"         ></td>
                            <td *ngIf="columnVisibility1.Supplier"            ></td>
                            <td *ngIf="columnVisibility1.TAXNo"               ></td>
                            <td *ngIf="columnVisibility1.ProductType"         ></td>
                            <td *ngIf="columnVisibility1.HSNCode"             ></td>
                            <td *ngIf="columnVisibility1.Product"             ></td>
                            <td *ngIf="columnVisibility1.Qty"                 >{{this.DetailtotalQty}}</td>
                            <td *ngIf="columnVisibility1.UnitPrice"           >{{this.DetailtotalUnitPrice}}</td>
                            <td *ngIf="columnVisibility1.Dis"                 >{{this.DetailtotalDiscount}}</td>
                            <td *ngIf="columnVisibility1.SubTotal"            >{{this.DetailtotalSubTotal}}</td>
                            <td *ngIf="columnVisibility1.TAXType"             ></td>
                            <td *ngIf="columnVisibility1.TAX"                 ></td>
                            <td *ngIf="columnVisibility1.TAXAmt"               (click)="openModal(content)"> {{this.DetailtotalGstAmount}}</td>
                            <td *ngIf="columnVisibility1.GrandTotal"           >{{this.DetailtotalAmount}}</td>
                            <td *ngIf="columnVisibility1.BarCode"              ></td>
                            <td *ngIf="columnVisibility1.PaymentStatus"        ></td>
                            <td *ngIf="columnVisibility1.RetailPer_PcPrice"    ></td>
                            <td *ngIf="columnVisibility1.RetailTotalPrice"     >{{this.TtlR}}</td>
                            <td *ngIf="columnVisibility1.WholeSalePer_PcPrice" ></td>
                            <td *ngIf="columnVisibility1.WholeSaleTotalPrice"  >{{this.TtlW}}</td>
                            <td *ngIf="columnVisibility1.CurrentShop"          ></td>
                          </tr>
                        </thead>
                        <tbody class="text-center">
                          <tr *ngFor="let s of PurchaseDetailList; let i = index" text="left">
                            <td>{{ i+1 }} </td>
                            <td *ngIf="columnVisibility1.InvoiceNo"    >{{s.InvoiceNo}}</td>
                            <td *ngIf="columnVisibility1.InvoiceDate"  >{{dateFormat(s.PurchaseDate)}}</td>
                            <td *ngIf="columnVisibility1.Supplier"     >{{s.SupplierName}}</td>
                            <td *ngIf="columnVisibility1.TAXNo"        >{{s.SupplierGSTNo}}</td>
                            <td *ngIf="columnVisibility1.ProductType"  >{{s.ProductTypeName}}</td>
                            <td *ngIf="columnVisibility1.HSNCode"      >{{s.HSNcode}}</td>
                            <td *ngIf="columnVisibility1.Product"      >{{s.ProductName}}</td>
                            <td *ngIf="columnVisibility1.Qty"          >{{s.Quantity}}</td>
                            <td *ngIf="columnVisibility1.UnitPrice"    >{{s.UnitPrice }}</td>
                            <td *ngIf="columnVisibility1.Dis"          >{{s.DiscountAmount }}</td>
                            <td *ngIf="columnVisibility1.SubTotal"     >{{s.SubTotal }}</td>
                            <td *ngIf="columnVisibility1.TAXType"      >{{s.GSTType}}</td>
                            <td *ngIf="columnVisibility1.TAX"          >{{s.GSTPercentage}}%</td>
                            <td *ngIf="columnVisibility1.TAXAmt"       >{{s.GSTAmount }}</td>
                            <td style="display: none;"><span
                                *ngIf="s.GSTType === 'CGST-SGST'">{{s.GSTPercentage/2}}</span></td>
                            <td style="display: none;"><span *ngIf="s.GSTType === 'CGST-SGST'">{{s.GSTAmount/2}} </span>
                            </td>
                            <td style="display: none;"><span
                                *ngIf="s.GSTType === 'CGST-SGST'">{{s.GSTPercentage/2}}</span></td>
                            <td style="display: none;"><span *ngIf="s.GSTType === 'CGST-SGST'">{{s.GSTAmount/2}}</span>
                            </td>
                            <td style="display: none;"><span *ngIf="s.GSTType === 'IGST'">{{s.GSTPercentage}}</span>
                            </td>
                            <td style="display: none;"><span *ngIf="s.GSTType === 'IGST'">{{s.GSTAmount}}</span></td>
                            <td *ngIf="columnVisibility1.GrandTotal"           >{{s.TotalAmount }}</td>
                            <td *ngIf="columnVisibility1.BarCode"              >{{s.BaseBarCode}}</td>
                            <td *ngIf="columnVisibility1.PaymentStatus"        >{{s.PaymentStatus}}</td>
                            <td *ngIf="columnVisibility1.RetailPer_PcPrice"    >{{s.RetailPrice }}</td>
                            <td *ngIf="columnVisibility1.RetailTotalPrice"     >{{s.RetailPrice * s.Quantity}}</td>
                            <td *ngIf="columnVisibility1.WholeSalePer_PcPrice" >{{s.WholeSalePrice }}</td>
                            <td *ngIf="columnVisibility1.WholeSaleTotalPrice"  >{{s.WholeSalePrice * s.Quantity}}</td>
                            <td *ngIf="columnVisibility1.CurrentShop"          >{{s.ShopName}}<span [style.color]="'blue'"
                                *ngIf="s.AreaName !== 'null'">({{s.AreaName}})</span></td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </mat-tab>
              <!-- Purchase Charge -->
              <mat-tab *ngIf="viewPurchaseChargeReport" label="Purchase Charge">
                <div class="body">
                  <form class="p-3 pb-0" #f3="ngForm" (ngSubmit)="purchaseCharge()">
                    <div class="row" >
                      <div class="col-xl-2 col-lg-2 col-md-3 col-6 mb-0">
                        <mat-form-field class="example-full-width mb-0">
                          <mat-label>From Date</mat-label>
                          <input matInput name="FromDate" type="date" [(ngModel)]="charge.FromDate" #DOBcontrol
                            [disabled]="!editPurchaseChargeReport" />
                        </mat-form-field>
                      </div>
                      <div class="col-xl-2 col-lg-2 col-md-3 col-6 mb-0">
                        <mat-form-field class="example-full-width mb-0">
                          <mat-label>To Date</mat-label>
                          <input matInput name="ToDate" type="date" [(ngModel)]="charge.ToDate"
                            [disabled]="!editPurchaseChargeReport" />
                        </mat-form-field>
                      </div>
                      <div class="col-xl-2 col-lg-4 col-md-6 col-12 mb-0 ">
                        <mat-form-field class="example-full-width mb-0" *ngIf="user.UserGroup === 'CompanyAdmin'">
                          <mat-label>Shop Name</mat-label>
                          <mat-select name="shopID" [(ngModel)]="charge.ShopID" multiple>
                            <mat-option [value]=0>All</mat-option>
                            <mat-option [value]="s.ID" *ngFor="let s of shopList">
                              {{s.Name}}
                              <span [style.color]="'blue'" *ngIf="s.AreaName !== 'null'">({{s.AreaName}})</span>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                        <mat-form-field class="example-full-width mb-0" *ngIf="user.UserGroup !== 'CompanyAdmin'">
                          <mat-label>Shop Name</mat-label>
                          <mat-select name="shopID" [(ngModel)]="charge.ShopID">
                            <mat-option [value]="s.ID" *ngFor="let s of shopList">
                              {{s.Name}}
                              <span [style.color]="'blue'" *ngIf="s.AreaName !== 'null'">({{s.AreaName}})</span>
                            </mat-option>
                          </mat-select>
                        </mat-form-field>
                      </div>
                      <div class="col-xl-3 col-lg-4 col-md-6 col-12 mb-0">
                        <button class="me-3" mat-raised-button color="primary">Search</button>
                        <button class="mr-0" type="button" mat-raised-button color="warn"
                          (click)="purchaseChargeFromReset()">Reset</button>

                      </div>
                    </div>
                  </form>
                  <div class="body p-2">
                    <div id="PurchaseService-content" class="col-sm-12" style="overflow: auto; height: 450px;">
                      <table class="table table-striped table-hover table-sm table-bordered"
                        style="border: 2px solid #fff !important;" id="purchaseChargeExcel">
                        <thead>
                          <tr style="white-space: nowrap;">
                            <th>S.No</th>
                            <th *ngIf="columnVisibility2.ShopName"      >ShopName</th>
                            <th *ngIf="columnVisibility2.InvoiceNo"     >InvoiceNo</th>
                            <th *ngIf="columnVisibility2.Description"   >Description</th>
                            <th *ngIf="columnVisibility2.Amount"        >Amount</th>
                            <th *ngIf="columnVisibility2.TAXType"       >TAXType</th>
                            <th *ngIf="columnVisibility2.TAX"           >TAX%</th>
                            <th *ngIf="columnVisibility2.TAXAmount"     >TAXAmount</th>
                            <th *ngIf="columnVisibility2.GrandTotal"    >GrandTotal</th>
                          </tr>
                          <tr class="totolRow" *ngIf="this.ChargeAmount != null && this.ChargeAmount != '' ">
                            <td>
                              <i class="fa fa-file-excel-o excel" title="ExportAsXLSX" aria-hidden="true" type="button"
                                (click)="exportAsXLSXcharge()">
                              </i>
                              <button class="bg_none ms-4 me-2" (click)="print('PurchaseService-content')" >
                                <i class="far fa-file-pdf "
                                    style="color: #1a1e90;font-size: 22px;cursor: pointer;"> </i>
                            </button>

                            <div class="button-container">
                              <button class="bg_none">
                                  <i class="fa-solid fa-filter" style="font-size: 20px; color: #f44336;"></i>
                              </button>
                              <div class="hover-box">
                                <button (click)="toggleColumnVisibility2('ShopName')">
                                  <mat-checkbox class="me-2" name="ShopName" [(ngModel)]="columnVisibility2.ShopName"></mat-checkbox>
                                   ShopName
                              </button>
                              <button (click)="toggleColumnVisibility2('InvoiceNo')">
                                  <mat-checkbox class="me-2" name="InvoiceNo" [(ngModel)]="columnVisibility2.InvoiceNo"></mat-checkbox>
                                     InvoiceNo
                              </button>
                                <button (click)="toggleColumnVisibility2('Description')">
                                  <mat-checkbox class="me-2" name="Description" [(ngModel)]="columnVisibility2.Description"></mat-checkbox>
                                   Description
                              </button>
                              <button (click)="toggleColumnVisibility2('Amount')">
                                  <mat-checkbox class="me-2" name="Amount" [(ngModel)]="columnVisibility2.Amount"></mat-checkbox>
                                     Amount
                              </button>
                                <button (click)="toggleColumnVisibility2('TAXType')">
                                  <mat-checkbox class="me-2" name="TAXType" [(ngModel)]="columnVisibility2.TAXType"></mat-checkbox>
                                   TAXType
                              </button>
                              <button (click)="toggleColumnVisibility2('TAX')">
                                  <mat-checkbox class="me-2" name="TAX" [(ngModel)]="columnVisibility2.TAX"></mat-checkbox>
                                     TAX
                              </button>
                                <button (click)="toggleColumnVisibility2('TAXAmount')">
                                  <mat-checkbox class="me-2" name="TAXAmount" [(ngModel)]="columnVisibility2.TAXAmount"></mat-checkbox>
                                   TAXAmount
                              </button>
                              <button (click)="toggleColumnVisibility2('GrandTotal')">
                                  <mat-checkbox class="me-2" name="GrandTotal" [(ngModel)]="columnVisibility2.GrandTotal"></mat-checkbox>
                                     GrandTotal
                              </button>

                              </div>
                          </div>
                            </td>
                            <td *ngIf="columnVisibility2.ShopName"     ></td>
                            <td *ngIf="columnVisibility2.InvoiceNo"    ></td>
                            <td *ngIf="columnVisibility2.Description"  ></td>
                            <td *ngIf="columnVisibility2.Amount"       >{{this.ChargeAmount}}</td>
                            <td *ngIf="columnVisibility2.TAXType"      ></td>
                            <td *ngIf="columnVisibility2.TAX"          ></td>
                            <td *ngIf="columnVisibility2.TAXAmount"     (click)="openModal1(content1)">{{this.ChargetotalGstAmount}}</td>
                            <td *ngIf="columnVisibility2.GrandTotal"   ></td>
                          </tr>
                        </thead>
                        <tbody class="text-center">
                          <tr *ngFor="let c of PurchaseChargeList; let i = index" text="left">
                            <td> {{i+1 }} </td>
                            <td *ngIf="columnVisibility2.ShopName"     >{{c.ShopName}}<span [style.color]="'blue'"  *ngIf="c.AreaName !== 'null'">({{c.AreaName}})</span> </td>
                            <td *ngIf="columnVisibility2.InvoiceNo"    >{{c.InvoiceNo}}</td>
                            <td *ngIf="columnVisibility2.Description"  >{{c.Description}}</td>
                            <td *ngIf="columnVisibility2.Amount"       >{{c.Amount }}</td>
                            <td *ngIf="columnVisibility2.TAXType"      >{{c.GSTType}}</td>
                            <td *ngIf="columnVisibility2.TAX"          >{{c.GSTPercentage}}%</td>
                            <td *ngIf="columnVisibility2.TAXAmount"    >{{c.GSTAmount }}</td>
                            <td *ngIf="columnVisibility2.GrandTotal"   >{{c.TotalAmount }}</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </mat-tab>
            
              <mat-tab *ngIf="viewSupplierDueAmonutReport" label="Supplier Due Amonut">
                <div class="body">
                    <form class="p-3 pb-0" #f1="ngForm" (ngSubmit)="getVendorDuePayment()">
                        <div class="row">
                            <div class="col-xl-2 col-lg-2 col-md-6 col-6 mb-0 ">
                                <mat-form-field class="example-full-width mb-0 paddingInp">
                                    <mat-label>From</mat-label>
                                    <input matInput name="FromDate" type="date"
                                        [(ngModel)]="data1.FromDate" #DOBcontrol
                                        />
                                </mat-form-field>
                            </div>
                            <div class="col-xl-2 col-lg-2 col-md-6 col-6 mb-0 ">
                                <mat-form-field class="example-full-width mb-0 paddingInp ">
                                    <mat-label>To</mat-label>
                                    <input matInput type="date" name="ToDate" [(ngModel)]="data1.ToDate"
                                         />
                                </mat-form-field>
                            </div>
                            <div class="col-xl-2 col-lg-2 col-md-4 col-12 mb-0 ">
                                <mat-form-field class="example-full-width mb-0">
                                    <mat-label>Supplier Name</mat-label>
                                    <mat-select name="Supplier" [(ngModel)]="data1.SupplierID"
                                        editable="true" #singleSelect>
                                        <mat-option [value]="0">All</mat-option>
                                        <mat-option *ngFor="let sup of supplierList  let i = index;"
                                            [value]="sup.ID">
                                            {{sup.Name}}<span style="float: right;">{{sup.MobileNo1}}
                                            </span>
                                        </mat-option>
                                    </mat-select>
                                    <mat-error>
                                        Select Supplier
                                    </mat-error>
                                </mat-form-field>
                                <!-- <mat-form-field class="example-full-width">
                                <mat-label>Supplier Name</mat-label>
                                <input type="text" placeholder="serach customer" aria-label="Text" matInput
                                name="SupplierID"  [formControl]="myControl" [matAutocomplete]="auto"
                                       (input)="customerSearch(myControl.value, 'Name','Supplier')">
                                <mat-autocomplete autoActiveFirstOption #auto="matAutocomplete" >
                                  <mat-option (click)="CustomerSelection('All','0')" value='All'>All</mat-option>
                                  <mat-option (click)="CustomerSelection('data1',option.ID)" *ngFor="let option of filteredOptions" [value]="option.Name">
                                    {{option.Name}} {{option.MobileNo1}}
                                  </mat-option>
                                </mat-autocomplete>
                              </mat-form-field> -->
                            </div>
                            <div class="col-xl-2 col-lg-2 col-md-6 col-12 mb-0">
                                <mat-form-field class="example-full-width mb-0"
                                    *ngIf="user.UserGroup === 'CompanyAdmin'">
                                    <mat-label>Shop Name</mat-label>
                                    <mat-select name="ShopID" [(ngModel)]="data1.ShopID" multiple>
                                        <mat-option [value]=0>All</mat-option>
                                        <mat-option [value]="Fs.ID" *ngFor="let Fs of shopList">
                                            {{Fs.Name}}
                                            <span [style.color]="'blue'"
                                                *ngIf="Fs.AreaName !== 'null'">({{Fs.AreaName}})</span>
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                                <mat-form-field class="example-full-width mb-0"
                                    *ngIf="user.UserGroup !== 'CompanyAdmin'">
                                    <mat-label>Shop Name</mat-label>
                                    <mat-select name="ShopID" [(ngModel)]="data1.ShopID">
                                        <mat-option [value]="Fs.ID" *ngFor="let Fs of shopList">
                                            {{Fs.Name}}
                                            <span [style.color]="'blue'"
                                                *ngIf="Fs.AreaName !== 'null'">({{Fs.AreaName}})</span>
                                        </mat-option>
                                    </mat-select>
                                </mat-form-field>
                            </div>
                            <!--  spec end -->
                            <div class="col-xl-2 col-lg-4 col-md-6 col-12 mb-0 ">
                                <button class="me-3" type="submit" mat-raised-button color="primary">
                                    Search
                                </button>
                                <button type="button" mat-raised-button color="warn"
                                    (click)="FromReset1()">
                                    Reset
                                </button>
                            </div>
                        </div>
                    </form>
                    <!-- TransfermasterList list -->
                    <div class="body p-2">
                        <div id="print-content1" class="col-sm-12"
                            style="overflow: auto; height: 450px;">
                            <table class="table table-striped table-hover table-sm table-bordered"
                                style="border: 2px solid #fff !important;" id="SupplierDuaExcel">
                                <thead>
                                    <tr style="white-space: nowrap;">
                                        <th>S.No</th>
                                        <th>SupplierName</th>
                                        <th>InvoiceNo</th>
                                        <th>PurchaseDate</th>
                                        <th>Quantity</th>
                                        <th>SubTotal</th>
                                        <th>DiscountAmount</th>
                                        <th>GSTAmount</th>
                                        <th>TotalAmount</th>
                                        <th>DueAmount</th>
                                        <th>PaidAmount</th>
                                        <th>PaymentStatus</th>
                                        <th>ShopName</th>
                                    </tr>
                                    <tr class="totolRow "
                                        *ngIf="this.dataList1 != null && this.dataList1 != ''">
                                        <td>
                                            <i class="fa fa-file-excel-o excel" title="ExportAsXLSX"
                                                aria-hidden="true" type="button"
                                                (click)="exportAsXLSX1()"> </i>
                                            <button class="bg_none ms-4 me-2" (click)="print1()">
                                                <i class="far fa-file-pdf "
                                                    style="color: #1a1e90;font-size: 22px;cursor: pointer;">
                                                </i>
                                            </button>
                                            <div class="button-container">
                                                <button class="bg_none">
                                                    <i class="fa-solid fa-filter"
                                                        style="font-size: 20px; color: #f44336;"></i>
                                                </button>
                                            </div>
                                        </td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td>{{this.totalQtyD}}</td>
                                        <td>{{this.totalSubTotalD}}</td>
                                        <td>{{this.totalDiscountD}}</td>
                                        <td>{{this.totalGstAmountD}}</td>
                                        <td>{{this.totalAmountD}}</td>
                                        <td>{{this.totalDueAmountD}}</td>
                                        <td>{{this.totalPaidAmountD}}</td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                </thead>
                                <tbody class="text-center">
                                    <tr *ngFor="let data of dataList1; let i = index" text="left">
                                        <td>{{ i + 1 }}</td>
                                        <td>{{data.SupplierName}}</td>
                                        <td>{{data.InvoiceNo}}</td>
                                        <td>{{dateFormat(data.PurchaseDate)}}</td>
                                        <td>{{data.Quantity}}</td>
                                        <td>{{data.SubTotal}}</td>
                                        <td>{{data.DiscountAmount}} </td>
                                        <td>{{data.GSTAmount}}</td>
                                        <td>{{data.TotalAmount}}</td>
                                        <td>{{data.DueAmount}} </td>
                                        <td>{{data.TotalAmount - data.DueAmount}}</td>
                                        <td>{{data.PaymentStatus}}</td>
                                        <td>{{data.ShopName}}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </mat-tab>
            <mat-tab label="Purchase Register">
              <div class="body">
                  <form class="p-3 pb-0" #fr="ngForm" (ngSubmit)="getRegisterSale()">
                      <div class="row">

                          <div class="col-xl-2 col-lg-2 col-md-3 col-12 mb-0 ">
                              <mat-form-field class="example-full-width mb-0">
                                  <mat-label>Filter Types</mat-label>
                                  <mat-select name="FilterTypes" [(ngModel)]="FilterTypeR"
                                      (selectionChange)="ChangeDate()" required>
                                      <mat-option value="YearMonthWise">YearMonthWise</mat-option>
                                      <mat-option value="YearWise">YearWise</mat-option>
                                  </mat-select>
                              </mat-form-field>
                          </div>

                          <div class="col-xl-2 col-lg-2 col-md-3 col-12 mb-0 "
                              *ngIf='FilterTypeR == "YearWise"'>
                              <mat-form-field class="example-full-width mb-0">
                                  <mat-label>From</mat-label>
                                  <mat-select name="FromDate" [(ngModel)]="dataRegister.FromDate"
                                      required>
                                      <mat-option value="2022-01-01">2022</mat-option>
                                      <mat-option value="2023-01-01">2023</mat-option>
                                      <mat-option value="2024-01-01">2024</mat-option>
                                      <mat-option value="2025-01-01">2025</mat-option>
                                      <mat-option value="2026-01-01">2026</mat-option>
                                      <mat-option value="2027-01-01">2027</mat-option>
                                      <mat-option value="2028-01-01">2028</mat-option>
                                      <mat-option value="2029-01-01">2029</mat-option>
                                      <mat-option value="2030-01-01">2030</mat-option>
                                      <mat-option value="2031-01-01">2031</mat-option>
                                      <mat-option value="2032-01-01">2032</mat-option>
                                      <mat-option value="2033-01-01">2033</mat-option>
                                      <mat-option value="2034-01-01">2034</mat-option>
                                      <mat-option value="2035-01-01">2035</mat-option>
                                      <mat-option value="2036-01-01">2036</mat-option>
                                      <mat-option value="2037-01-01">2037</mat-option>
                                      <mat-option value="2038-01-01">2038</mat-option>
                                      <mat-option value="2039-01-01">2039</mat-option>
                                      <mat-option value="2040-01-01">2040</mat-option>
                                  </mat-select>
                              </mat-form-field>
                          </div>
                          <div class="col-xl-2 col-lg-2 col-md-3 col-12 mb-0 "
                              *ngIf='FilterTypeR == "YearWise"'>
                              <mat-form-field class="example-full-width mb-0">
                                  <mat-label>ToDate</mat-label>
                                  <mat-select name="ToDate" [(ngModel)]="dataRegister.ToDate"
                                      required>
                                      <mat-option value="2022-12-31">2022</mat-option>
                                      <mat-option value="2023-12-31">2023</mat-option>
                                      <mat-option value="2024-12-31">2024</mat-option>
                                      <mat-option value="2025-12-31">2025</mat-option>
                                      <mat-option value="2026-12-31">2026</mat-option>
                                      <mat-option value="2027-12-31">2027</mat-option>
                                      <mat-option value="2028-12-31">2028</mat-option>
                                      <mat-option value="2029-12-31">2029</mat-option>
                                      <mat-option value="2030-12-31">2030</mat-option>
                                      <mat-option value="2031-12-31">2031</mat-option>
                                      <mat-option value="2032-12-31">2032</mat-option>
                                      <mat-option value="2033-12-31">2033</mat-option>
                                      <mat-option value="2034-12-31">2034</mat-option>
                                      <mat-option value="2035-12-31">2035</mat-option>
                                      <mat-option value="2036-12-31">2036</mat-option>
                                      <mat-option value="2037-12-31">2037</mat-option>
                                      <mat-option value="2038-12-31">2038</mat-option>
                                      <mat-option value="2039-12-31">2039</mat-option>
                                      <mat-option value="2040-12-31">2040</mat-option>
                                  </mat-select>
                              </mat-form-field>
                          </div>

                          <div class="col-xl-2 col-lg-2 col-md-3 col-6 mb-0 "
                              *ngIf='FilterTypeR == "YearMonthWise"'>
                              <mat-form-field class="example-full-width mb-0">
                                  <mat-label>From</mat-label>
                                  <input matInput name="FromDate" type="month" required
                                      [(ngModel)]="dataRegister.FromDate" #Fromcontrol>
                              </mat-form-field>
                          </div>

                          <div class="col-xl-2 col-lg-2 col-md-3 col-6 mb-0 "
                              *ngIf='FilterTypeR == "YearMonthWise"'>
                              <mat-form-field class="example-full-width mb-0">
                                  <mat-label>To</mat-label>
                                  <input matInput name="ToDate" type="month" required
                                      [(ngModel)]="dataRegister.ToDate" #Fromcontrol>
                              </mat-form-field>
                          </div>



                          <div class="col-xl-2 col-lg-2 col-md-4 col-6 mb-0 ">
                              <mat-form-field class="example-full-width mb-0"
                                  *ngIf="user.UserGroup === 'CompanyAdmin'">
                                  <mat-label>Shop Name</mat-label>
                                  <mat-select name="shopID" [(ngModel)]="dataRegister.ShopID" multiple
                                      required>
                                      <mat-option [value]=0>All</mat-option>
                                      <mat-option [value]="s.ID" *ngFor="let s of shopList">
                                          {{s.Name}}
                                          <span [style.color]="'blue'"
                                              *ngIf="s.AreaName !== 'null'">({{s.AreaName}})</span>
                                      </mat-option>
                                  </mat-select>
                              </mat-form-field>
                              <mat-form-field class="example-full-width mb-0"
                                  *ngIf="user.UserGroup !== 'CompanyAdmin'">
                                  <mat-label>Shop Name</mat-label>
                                  <mat-select name="shopID" [(ngModel)]="dataRegister.ShopID">
                                      <mat-option [value]="s.ID" *ngFor="let s of shopList">
                                          {{s.Name}}
                                          <span [style.color]="'blue'"
                                              *ngIf="s.AreaName !== 'null'">({{s.AreaName}})</span>
                                      </mat-option>
                                  </mat-select>
                              </mat-form-field>
                          </div>
                          <div class="col-xl-4 col-lg-4 col-md-6 col-12 mb-0 ">
                              <button type="submit" mat-raised-button color="primary"
                                  [disabled]="!fr.valid ">
                                  Search
                              </button>
                              <button class="me-3 ms-3" type="button" mat-raised-button color="warn">
                                  Reset
                              </button>
                          </div>
                      </div>
                  </form>
                  <div class="body p-2">
                      <div class="row">
                          <div class="col-xl-12 col-lg-12 col-md-12 col-12 mb-0 ">
                              <div id="ProductExpiry-content" class="col-sm-12"
                                  style="overflow: auto; height: 450px;">
                                  <table
                                      class="table table-striped table-hover table-sm table-bordered"
                                      style="border: 2px solid #fff !important;" id="saleExpiryExcel">
                                      <thead>
                                          <tr class="text-center" style="white-space: normal;">
                                              <th>S.No</th>
                                              <th>Month </th>
                                              <th>Amount</th>
                                             
                                          </tr>
                                          <tr class="totolRow"
                                              *ngIf="this.RegisterList != null && this.RegisterList != ''">
                                              <td></td>
                                              <td></td>
                                              <td>{{this.RegisterAmount}}</td>
                                            

                                          </tr>
                                      </thead>
                                      <tbody class="text-center">
                                          <tr *ngFor="let data of RegisterList; let i = index"
                                              text="left">
                                              <td>{{ i + 1 }}</td>
                                              <td (click)="openModalR(contentR,data)">
                                                  {{data.MonthYear}} {{data.YEAR}}</td>
                                              <td>{{data.Amount}}</td>
                                             

                                          </tr>
                                      </tbody>
                                  </table>
                              </div>
                              <div class="col-xl-6 col-lg-6 col-md-6 col-12 mb-0 ">
                                  <div style="width: 100%; height: 400px;">
                                   
                                    </div>
                              </div>
                          </div>
                      </div>
                  </div>
              </div>
          </mat-tab>
            </mat-tab-group>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- model detail-->
<ng-template #content3 role="document" let-modal>
  <div class="modal-header" style="height: 50px;">
    <h3 class="modal-title header pt-2" id="exampleModalLabel">TAX Amount List</h3>
    <button type="button" class="btn-close" aria-hidden="true" (click)="modal.dismiss('Cross click')"></button>
  </div>
  <div class="modal-body">
    <div class="row">
      <table class="table table-striped table-hover table-sm table-bordered" style="border: 2px solid #fff !important;">
        <thead>
          <tr>
            <th>TAXType</th>
            <th>TAXAmount</th>
          </tr>
        </thead>
        <tbody>
          <tr class="text-center" *ngFor="let gst of gstMaster let i = index;">
            <td>{{gst.GSTType}}</td>
            <td>{{gst.Amount.toFixed(2)}}</td>
          </tr>
        </tbody>
        <tfoot class="text-center">
          <tr>
            <th style="color: red; font-weight: 600;">Total Amt</th>
            <th style="color: red; font-weight: 600;">{{this.totalGstAmount }}</th>
          </tr>
        </tfoot>
      </table>
    </div>
  </div>
</ng-template>

<!-- model detail-->
<ng-template #content role="document" let-modal>
  <div class="modal-header" style="height: 50px;">
    <h3 class="modal-title header pt-2" id="exampleModalLabel">TAX Amount List</h3>
    <button type="button" class="btn-close" aria-hidden="true" (click)="modal.dismiss('Cross click')"></button>
  </div>
  <div class="modal-body">
    <div class="row">
      <table class="table table-striped table-hover table-sm table-bordered" style="border: 2px solid #fff !important;">
        <thead>
          <tr>
            <th>TAXType</th>
            <th>TAXAmount</th>
          </tr>
        </thead>
        <tbody>
          <tr class="text-center" *ngFor="let gst of gstdetails let i = index;">
            <td>{{gst.GSTType}}</td>
            <td>{{gst.Amount.toFixed(2)}}</td>
          </tr>
        </tbody>
        <tfoot class="text-center">
          <tr>
            <th style="color: red; font-weight: 600;">Total Amt</th>
            <th style="color: red; font-weight: 600;">{{this.DetailtotalGstAmount }}</th>
          </tr>
        </tfoot>
      </table>
    </div>
  </div>
</ng-template>

<!--Charge model -->
<ng-template #content1 role="document" let-modal>
  <div class="modal-header" style="height: 50px;">
    <h3 class="modal-title header pt-2" id="exampleModalLabel">TAX Amount List</h3>
    <button type="button" class="btn-close" aria-hidden="true" (click)="modal.dismiss('Cross click')"></button>
  </div>
  <div class="modal-body">
    <div class="row">
      <table class="table table-striped table-hover table-sm table-bordered" style="border: 2px solid #fff !important;">
        <thead>
          <tr>
            <th>TAXType</th>
            <th>TAXAmount</th>
          </tr>
        </thead>
        <tbody>
          <tr class="text-center" *ngFor="let gst of gstCharge let i = index;">
            <td>{{gst.GSTType}}</td>
            <td>{{gst.Amount.toFixed(2)}}</td>
          </tr>
        </tbody>
        <tfoot class="text-center">
          <tr>
            <th style="color: red; font-weight: 600;">Total Amt</th>
            <th style="color: red; font-weight: 600;">{{this.ChargetotalGstAmount }}</th>
          </tr>
        </tfoot>
      </table>
    </div>
  </div>
</ng-template>

<!--ProductExpiry model -->
<ng-template #content2 role="document" let-modal>
  <div class="modal-header" style="height: 50px;">
    <h3 class="modal-title header pt-2" id="exampleModalLabel">TAX Amount List</h3>
    <button type="button" class="btn-close" aria-hidden="true" (click)="modal.dismiss('Cross click')"></button>
  </div>
  <div class="modal-body">
    <div class="row">
      <table class="table table-striped table-hover table-sm table-bordered" style="border: 2px solid #fff !important;">
        <thead>
          <tr>
            <th>TAXType</th>
            <th>TAXAmount</th>
          </tr>
        </thead>
        <tbody>
          <tr class="text-center" *ngFor="let gst of gstExpirys let i = index;">
            <td>{{gst.GSTType}}</td>
            <td>{{gst.Amount.toFixed(2)}}</td>
          </tr>
        </tbody>
        <tfoot class="text-center">
          <tr>
            <th style="color: red; font-weight: 600;">Total Amt</th>
            <th style="color: red; font-weight: 600;">{{this.ExpirytotalGstAmount }}</th>
          </tr>
        </tfoot>
      </table>
    </div>
  </div>
</ng-template>

<ng-template #content00 role="document" let-modal>
  <div class="modal-header" style="height: 50px; border-bottom: #ff651e 3px solid;">
    <div class="container">
        <div class="row pt-3">
            <div class="col-1">
                <h2 class="modal-title header " id="exampleModalLabel">Grid
              </h2>
            </div>
             <!--  <div class="col-4 ">
               <button mat-raised-button
                    [ngStyle]="{'background-color': isActive1 ? '#3f51b5' : '#dddddd','color':isActive1 ? '#fff' : '#000'}"
                    (click)="plusToplus('+sph+cyl'); toggleActive(1)">
                    +/+
                </button>

                <button mat-raised-button
                    [ngStyle]="{'background-color': isActive2 ? '#3f51b5' : '#dddddd','color':isActive2 ? '#fff' : '#000'}"
                    (click)="plusToplus('-sph-cyl'); toggleActive(2)" class="ms-2 me-2">
                    -/-
                </button>

                <button mat-raised-button
                    [ngStyle]="{'background-color': isActive3 ? '#3f51b5' : '#dddddd','color':isActive3 ? '#fff' : '#000'}"
                    (click)="plusToplus('+sph-cyl'); toggleActive(3)">
                    +/-
                </button> 
            </div> -->
             
              <div class="col-xl-2 col-lg-2 col-md-2 col-sm-6 col-4 ms-auto mb-0">
                <mat-form-field class="example-full-width mb-0">
                  <mat-label>Index</mat-label>
                  <mat-select name="SVType" [(ngModel)]="SVType"  #SVTypecontrol >
                      <mat-option value="1.56">1.56 Index</mat-option>
                      <mat-option value="1.61">1.61 Index</mat-option>
                      <mat-option value="1.499">1.499 Index</mat-option>
                      <mat-option value="1.56 Progressive">1.56 Progressive (-)</mat-option>
                      <mat-option value="1.56 ProPlus">1.56 Progressive(+)</mat-option>

                  </mat-select>
              </mat-form-field>

              </div>
              <div *ngIf="SVType == '1.56'" class=" col-2  mb-0">
                <mat-form-field class="example-full-width mb-0">
                    <mat-label>Select Base Type</mat-label>
                    <mat-select name="Base" [(ngModel)]="Base"  #Basecontrol (selectionChange)="baseChange1(this.Base,'1.56')">
                        <mat-option value="12">Base 12</mat-option>
                        <mat-option value="10">Base 10</mat-option>
                        <mat-option value="8">Base 8</mat-option>
                        <mat-option value="7">Base 7</mat-option>
                        <mat-option value="6">Base 6</mat-option>
                        <mat-option value="5">Base 5</mat-option>
                        <mat-option value="4">Base 4</mat-option>
                        <mat-option value="3">Base 3</mat-option>
                        <mat-option value="2">Base 2</mat-option>
                        <mat-option value="1">Base 1</mat-option>
                        <mat-option value="0.5">Base 0.5</mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div *ngIf="SVType == '1.61'" class=" col-2   mb-0">
              <mat-form-field class="example-full-width mb-0">
                  <mat-label>Select Base Type</mat-label>
                  <mat-select name="Base" [(ngModel)]="Base"  #Basecontrol (selectionChange)="baseChange1(this.Base,'1.61')">
                      <mat-option value="12">Base 12</mat-option>
                      <mat-option value="11">Base 11</mat-option>
                      <mat-option value="10">Base 10</mat-option>
                      <mat-option value="9">Base 9</mat-option>
                      <mat-option value="8">Base 8</mat-option>
                      <mat-option value="7">Base 7</mat-option>
                      <mat-option value="6">Base 6</mat-option>
                      <mat-option value="5">Base 5</mat-option>
                      <mat-option value="4">Base 4</mat-option>
                      <mat-option value="3">Base 3</mat-option>
                      <mat-option value="2">Base 2</mat-option>
                      <mat-option value="1">Base 1</mat-option>
                      <mat-option value="0.5">Base 0.5</mat-option>
                  </mat-select>
              </mat-form-field>
          </div>
          <div *ngIf="SVType == '1.499'" class=" col-2  mb-0">
              <mat-form-field class="example-full-width mb-0">
                  <mat-label>Select Base Type</mat-label>
                  <mat-select name="Base" [(ngModel)]="Base"  #Basecontrol (selectionChange)="baseChange1(this.Base,'1.499')">
                      <mat-option value="12">Base 12</mat-option>
                      <mat-option value="11">Base 11</mat-option>
                      <mat-option value="10">Base 10</mat-option>
                      <mat-option value="9">Base 9</mat-option>
                      <mat-option value="8">Base 8</mat-option>
                      <mat-option value="7">Base 7</mat-option>
                      <mat-option value="6">Base 6</mat-option>
                      <mat-option value="5">Base 5</mat-option>
                      <mat-option value="4">Base 4</mat-option>
                      <mat-option value="2">Base 2</mat-option>
                      <mat-option value="0">Base 0</mat-option>
                  </mat-select>
              </mat-form-field>
          </div>
          <div *ngIf="SVType == '1.56 Progressive'" class=" col-2  mb-0">
            <mat-form-field class="example-full-width mb-0">
                <mat-label>Select Base Type</mat-label>
                <mat-select name="Base" [(ngModel)]="Base"  #Basecontrol (selectionChange)="baseChange1(this.Base,'1.56 Progressive')">
                    <!-- <mat-option value="5">Base 5</mat-option> -->
                    <mat-option value="3">Base 3</mat-option>
                    <mat-option value="1">Base 1</mat-option>
                </mat-select>
            </mat-form-field>
        </div>
        <div *ngIf="SVType == '1.56 ProPlus'" class=" col-2  mb-0">
          <mat-form-field class="example-full-width mb-0">
              <mat-label>Select Base Type</mat-label>
              <mat-select name="Base" [(ngModel)]="Base"  #Basecontrol (selectionChange)="baseChange1(this.Base,'1.56 ProPlus')"> 
                  <mat-option value="5">Base 5</mat-option>
                  <mat-option value="3">Base 3</mat-option>
                  <mat-option value="1">Base 1</mat-option>
              </mat-select>
          </mat-form-field>
      </div>
          <div class="col-xl-2 col-lg-2 col-md-2 col-sm-6 col-4  mb-0">
            <mat-form-field class="example-full-width mb-0">
                <mat-label>Axis</mat-label>
                <mat-select name="axis" [(ngModel)]="axisFilter" #axiscontrol (selectionChange)="Axis1212()">
                    <mat-option [value]=0 >0</mat-option>
                    <mat-option [value]="a.Name" *ngFor="let a of axisList">
                        {{a.Name}}
                    </mat-option>
                </mat-select>
            </mat-form-field>
        </div>
        <div class="col-xl-2 col-lg-2 col-md-2 col-sm-6 col-4 mb-0">
          <mat-form-field class="example-full-width mb-0">
              <mat-label>Addtion</mat-label>
              <mat-select name="addtion" [(ngModel)]="addtionFilter" #addtioncontrol (selectionChange)="AddFilter()">
                <mat-option [value]=0 >0</mat-option>
                  <mat-option [value]="ad.Name" *ngFor="let ad of additionList">
                      {{ad.Name}}
                  </mat-option>
              </mat-select>
          </mat-form-field>
      </div>
              <div class="col-xl-1 col-lg-1 col-md-2 col-sm-6 col-4  mb-0">
                <button  mat-raised-button color="primary" type="button"
                (click)="exportAsXLSXlens()"> Excel </button> 

              </div>
            <!-- <div class="col-1 pt-1">
                <label>SPH-Min</label>
                <input type="number" placeholder="SPH-Min" style="width: 70px;" [(ngModel)]="sphMin">
            </div>
            <div class="col-1 pt-1">
                <label>SPH-Max</label>
                <input type="number" placeholder="SPH-Max" style="width: 70px;" [(ngModel)]="sphMax">
            </div>
            <div class="col-1 pt-1">
                <label for="sph-step">SPH Step</label>
                <input id="sph-step" type="number" style="width: 70px;" [(ngModel)]="sphStep">
            </div>
            <div class="col-1 pt-1">
                <label for="cyl-step">CYL-Min</label>
                <input type="number" placeholder="CLY-Min" style="width: 70px;" [(ngModel)]="cylMin">
            </div>
            <div class="col-1 pt-1">
                <label for="cyl-step">CYL-Max</label>
                <input type="number" placeholder="CLY-Max" style="width: 70px;" [(ngModel)]="cylMax">
            </div>
            <div class="col-1 pt-1">
                <label for="cyl-step">CYL Step</label>
                <input id="cyl-step" type="number" style="width: 70px;" [(ngModel)]="cylStep">
            </div>
            <div class="col-1 pt-3">
                <button mat-raised-button color="primary" (click)="generateGrid()">Show</button>

            </div> -->
        </div>
    </div>
    <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
</div>
<div class="modal-body p-0">
    <div class="row">
        <div class="col-12 mx-auto" style="overflow: scroll;height: 550px;">
          <div class="container p-0" *ngIf="dataSource.length">
            <table mat-table [dataSource]="dataSource" class="mat-elevation-z8"
                style="overflow: auto; height: 480px; width: 100%;" id="lensExcel">
                <!-- CYL Column -->
                <ng-container matColumnDef="cyl">
                    <th mat-header-cell *matHeaderCellDef
                        style="font-size: 16px;color:rgb(0 0 0); border: 1px solid; padding: 0;text-align: center !important;">
                        CYL  <br> SPH </th>
                      
                    <td mat-cell *matCellDef="let element"
                        style="font-size: 16px;border: 1px solid   ;  padding: 3px;  text-align: center !important; font-weight: 500;background-color: #dddddd;"
                        class="hovertblrow-col"> {{element.sph}} </td>
                </ng-container>
                <!-- Dynamic Columns for SPH -->
                <ng-container *ngFor="let cyl of cylValues; let i = index" [matColumnDef]="cyl">
                    <th mat-header-cell *matHeaderCellDef
                        style="font-size: 16px; padding-top: 10px; color: rgb(0 0 0); border: 1px solid; text-align: center !important; background-color: #dddddd;">
                      {{ cyl }}
                    </th>
                    <!-- <td mat-cell *matCellDef="let element"
                        [style.backgroundColor]="element[cyl].isBlue ? '#fff' : 'transparent'"
                        [style.border]="element[cyl].isBlue ? '1px solid' : 'none'">
                      <ng-container *ngIf="element[cyl].isBlue">
                        <input class="inputBoxTD" type="number" [(ngModel)]="element[cyl].value" min="0"
                               [ngStyle]="{ 'color': element[cyl].value == 0 ? '#242424' : 'red', 'font-weight': element[cyl].value == 0 ? 'normal' : '900' }"
                               style="border: none !important;background: none;" disabled />
                      </ng-container>
                    </td> -->
                    <td mat-cell *matCellDef="let element"
                        [style.backgroundColor]="element[cyl].isBlue ? '#fff' : 'transparent'"
                        [style.border]="element[cyl].isBlue ? '1px solid' : 'none'">
                      <ng-container *ngIf="element[cyl].isBlue">
                        <span class="inputBoxTD" 
                               [ngStyle]="{ 'color': element[cyl].value == 0 ? '#242424' : 'red', 'font-weight': element[cyl].value == 0 ? 'normal' : '900' }"
                               style="border: none !important;background: none;" disabled >
                               {{element[cyl].value}}
                              </span>


                      </ng-container>
                    </td>

                

                  </ng-container>
                <tr mat-header-row *matHeaderRowDef="displayedColumns" style="height: -1px !important;"
                    class="hovertblrow-col"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"
                    [ngClass]="{'highlight-row': isHoveredRow(row)}" (click)="hoveredRow = row"
                    (mouseleave)="hoveredRow = null" style="height: -1px !important;" class="hovertblrow-col">
                </tr>
            </table>
        </div>
        </div>
        <!-- product-quantity-grid.component.html -->
        <!-- <div *ngIf="axisAddEyeShow == true" class="row ms-3">
            <div class="col-xl-1 col-lg-1 col-md-2 col-sm-6 col-4  mb-0">
                <mat-form-field class="example-full-width mb-0">
                    <mat-label>Axis</mat-label>
                    <mat-select name="axis" [(ngModel)]="lens.axis" #axiscontrol>
                        <mat-option [value]="a.Name" *ngFor="let a of axisList">
                            {{a.Name}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="col-xl-1 col-lg-1 col-md-2 col-sm-6 col-4  mb-0">
                <mat-form-field class="example-full-width mb-0">
                    <mat-label>Addtion</mat-label>
                    <mat-select name="addtion" [(ngModel)]="lens.addtion" #addtioncontrol>
                        <mat-option [value]="ad.Name" *ngFor="let ad of additionList">
                            {{ad.Name}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="col-xl-1 col-lg-1 col-md-2 col-sm-6 col-4  mb-0">
                <mat-form-field class="example-full-width mb-0">
                    <mat-label>Eye</mat-label>
                    <mat-select name="eye" [(ngModel)]="lens.eye" #eyecontrol>
                        <mat-option value="R">R</mat-option>
                        <mat-option value="L">L</mat-option>
                        <mat-option value="RL">RL</mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
        </div> -->
        <div class="row mt-2 ms-3">
            <!-- <div class="col-xl-1 col-lg-1 col-md-2 col-sm-6 col-4  mb-0">
                <mat-form-field class="example-full-width mb-0">
                    <mat-label>Purchase Price</mat-label>
                    <input matInput name="purchasePrice" [(ngModel)]="lens.purchasePrice" #purchasePricecontrol
                        [autocomplete]="false">
                    <mat-error>
                        Total Amount is required
                    </mat-error>
                </mat-form-field>
            </div> -->
            <!-- <div class="col-xl-1 col-lg-1 col-md-2 col-sm-6 col-4  mb-0">
                <mat-form-field class="example-full-width mb-0">
                    <mat-label>Qty++</mat-label>
                    <input matInput name="pp" value="{{this.pp}}" #quantitycontrol [autocomplete]="false"
                        disabled style="color: red !important; font-weight:700;">
                    <mat-error>
                        Total Amount is required
                    </mat-error>
                </mat-form-field>
            </div>
            <div class="col-xl-1 col-lg-1 col-md-2 col-sm-6 col-4  mb-0">
                <mat-form-field class="example-full-width mb-0">
                    <mat-label>Qty--</mat-label>
                    <input matInput name="mm" value="{{this.mm}}" #quantitycontrol [autocomplete]="false"
                        disabled style="color: red !important; font-weight:700;">
                    <mat-error>
                        Total Amount is required
                    </mat-error>
                </mat-form-field>
            </div>
            <div class="col-xl-1 col-lg-1 col-md-2 col-sm-6 col-4  mb-0">
                <mat-form-field class="example-full-width mb-0">
                    <mat-label>Qty+-</mat-label>
                    <input matInput name="pm" value="{{this.pm}}" #quantitycontrol [autocomplete]="false"
                        disabled style="color: red !important; font-weight:700;">
                    <mat-error>
                        Total Amount is required
                    </mat-error>
                </mat-form-field>
            </div>
            <div class="col-xl-1 col-lg-1 col-md-2 col-sm-6 col-4  mb-0">
                <mat-form-field class="example-full-width mb-0">
                    <mat-label>Total Qty</mat-label>
                    <input matInput name="lenQty" value="{{this.lenQty}}" #lenQtycontrol [autocomplete]="false"
                        disabled style="color: red !important; font-weight:700;">
                    <mat-error>
                        Total Amount is required
                    </mat-error>
                </mat-form-field>
            </div> -->
            <!-- <div class="col-xl-1 col-lg-1 col-md-2 col-sm-6 col-4  mb-0">
                <mat-form-field class="example-full-width mb-0">
                    <mat-label>Gst%</mat-label>
                    <input matInput name="GSTPercent" [(ngModel)]="lens.GSTPercent" #GSTPercentcontrol
                        [autocomplete]="false">
                    <mat-error>
                        Total Amount is required
                    </mat-error>
                </mat-form-field>
            </div>
            <div class="col-xl-1 col-lg-1 col-md-2 col-sm-6 col-4  mb-0">
                <mat-form-field *ngIf="lens.GSTPercent !== 0" class="example-full-width mb-0">
                    <mat-label>TAX Type</mat-label>
                    <mat-select name="GSTtype" [(ngModel)]="lens.GSTtype" #GSTTypeacontrol required>
                        <span>
                            <mat-option [value]="g.Name" *ngFor="let g of gstList">
                                {{g.Name}}
                            </mat-option>
                        </span>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="col-xl-1 col-lg-1 col-md-2 col-sm-6 col-4  mb-0" *ngIf="shop[0].RetailBill === 'true'">
                <mat-form-field class="example-full-width mb-0">
                    <mat-label>Retail Price</mat-label>
                    <input matInput name="retailPrice" [(ngModel)]="lens.retailPrice" #retailPricecontrol
                        [autocomplete]="false">
                    <mat-error>
                        Total Amount is required
                    </mat-error>
                </mat-form-field>
            </div>
            <div class="col-xl-1 col-lg-1 col-md-2 col-sm-6 col-4  mb-0"
                *ngIf="shop[0].WholesaleBill === 'true'">
                <mat-form-field class="example-full-width mb-0">
                    <mat-label>Wholesale Price</mat-label>
                    <input matInput name="retailPrice" [(ngModel)]="lens.wholesalePrice" #retailPricecontrol
                        [autocomplete]="false">
                    <mat-error>
                        Total Amount is required
                    </mat-error>
                </mat-form-field>
            </div> -->
            <div class="col-xl-1 col-lg-1 col-md-2 col-sm-6 col-4  mb-0">
                <!-- <button mat-raised-button color="primary" [disabled]="totalQty == 0"
                    (click)="purchase('save')">Purchase</button> -->
            </div>
        </div>
    </div>
</div>
  
</ng-template>

<ng-template #content01 role="document" let-modal>
  <div class="modal-header" style="height: 50px; border-bottom: #ff651e 3px solid;">
      <div class="container ">
          <div class="row">
              <div class="col-4">
                  <h2 class="modal-title header pt-2" id="exampleModalLabel"> {{this.BaseS}} Semi-Finished Grid</h2>
              </div>
              <!-- <div class=" col-2 pt-3  mb-0">
                  <mat-form-field class="example-full-width mb-0">
                      <mat-label>Index</mat-label>
                      <mat-select name="SVTypeS" [(ngModel)]="SVTypeS"  #SVTypecontrol >
                          <mat-option value="1.56">1.56 Index</mat-option>
                      </mat-select>
                  </mat-form-field>
              </div>
              <div *ngIf="SVTypeS == '1.56'" class=" col-2 pt-3  mb-0">
                  <mat-form-field class="example-full-width mb-0">
                      <mat-label>Select Base Type</mat-label>
                      <mat-select name="BaseS" [(ngModel)]="BaseS"  #Basecontrol (selectionChange)="baseChangeS(this.BaseS)">
                          <mat-option value="Progressive">Progressive</mat-option>
                          <mat-option value="Bifocal">Bifocal</mat-option>
                          <mat-option value="Single Vision">Single Vision</mat-option>
                      </mat-select>
                  </mat-form-field>
              </div> -->
           
          </div>
      </div>
      <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
  </div>
  <div class="modal-body p-0">
      <div class="row">
          <div class="col-12">
              <form #fg="ngForm">
              <div class="row">
                 
                      <!-- <div class="col-xl-2 col-lg-2 col-md-6 col-sm-12 mb-0 mt-1 ms-2">
                          <mat-form-field class="example-full-width mb-0 paddingInp">
                              <mat-label>Select Product</mat-label>
                              <mat-select name="ProductCategory" [(ngModel)]="data.ProductCategory"
                                  (selectionChange)="getFieldList()" required #Typecontrol>
                                  <mat-option>
                                      <ngx-mat-select-search matInput [(ngModel)]="searchValue" (ngModelChange)="searchValue = onChange($event)" [ngModelOptions]="{standalone: true}">
                                      </ngx-mat-select-search>
                                  </mat-option>
                                  <mat-option *ngFor="let prod of prodList | proditemfilter: searchValue   let i = index;"
                                      [value]="prod.ID">
                                      {{prod.Name | uppercase}}
                                  </mat-option>
                              </mat-select>
                              <mat-error>
                                  Select Product Type
                              </mat-error>
                          </mat-form-field>
                      </div>
                 
                      <div class="col-xl-2 col-lg-2 col-md-6 col-sm-12 mb-0 mt-1"
                          *ngFor="let spec of specList ; let i = index;">
                          <div *ngIf="spec.FieldType === 'DropDown'" class="d-flex">
                              <mat-form-field class=" me-2 mb-0" *ngIf="spec.DisplayAdd === 0">
                                  <mat-label>{{spec.FieldName}}</mat-label>
                                  <mat-select name="{{spec.FieldName+'0'}}"
                                      [(ngModel)]="spec.SelectedValue"
                                      (selectionChange)="getFieldSupportData(i)" editable="true"
                                      [required]="spec.Required === 1" #singleSelect>
                                      <mat-option>
                                          <ngx-mat-select-search matInput [(ngModel)]="spec.EnteredValue" (ngModelChange)="spec.EnteredValue = onChange($event)" [ngModelOptions]="{standalone: true}">
                                          </ngx-mat-select-search>
                                      </mat-option>
                                      <mat-option>
                                      </mat-option>
                                      <mat-option *ngFor="let val of spec.SptFilterData | proditemfilterPurchase: spec.EnteredValue"
                                          [value]="val.TableValue">
                                          {{val.TableValue}}
                                      </mat-option>
                                  </mat-select>
                                  <mat-error>
                                      {{spec.FieldName}} is Required
                                  </mat-error>
                              </mat-form-field>
                          </div>
                          <div *ngIf="spec.FieldType === 'Text'" class="d-flex">
                              <mat-form-field class=" mr-0 mb-0">
                                  <mat-label>{{spec.FieldName}}</mat-label>
                                  <input matInput name="{{spec.FieldName+'2'}}"
                                      [(ngModel)]="spec.SelectedValue" [required]="spec.Required === 1"
                                      (blur)="getFieldSupportData(i)">
                                  <mat-error>
                                      {{spec.FieldName}} is Required
                                  </mat-error>
                              </mat-form-field>
                          </div>
                          <div *ngIf="spec.FieldType === 'Date'" class="d-flex">
                              <mat-form-field class=" mr-0 mb-0">
                                  <mat-label>{{spec.FieldName}}</mat-label>
                                  <input type="date" matInput name="{{spec.FieldName+'3'}}"
                                      [(ngModel)]="spec.SelectedValue" editable="true"
                                      [required]="spec.Required === 1">
                                  <mat-error>
                                      {{spec.FieldName}} is Required
                                  </mat-error>
                              </mat-form-field>
                          </div>
                          <div *ngIf="spec.FieldType === 'boolean'" class="d-flex">
                              <mat-slide-toggle name="{{spec.FieldName+'3'}}" color="primary"
                                  class="example-margin" #Multiplecontrolx
                                  [(ngModel)]="spec.SelectedValue">
                                  {{spec.FieldName}}</mat-slide-toggle>
                          </div>
                      </div>
                      <div class="col-xl-2 col-lg-2 col-md-6 col-sm-12 mb-0 mt-1 ms-2">
                          <button  type="button" mat-raised-button color="primary" [disabled]="!fg.valid" (click)="getProductLists()">Get</button>
                      </div> -->
                  </div>
              </form>
          </div>
         
          <!--  spec end -->
          <div class="col-12 mx-auto">
              <div class="container p-0" *ngIf="dataSourceS.length">
                  <table mat-table [dataSource]="dataSourceS" class="mat-elevation-z8"
                      style="overflow: auto; height: 480px; width: 100%;">
                      <!-- CYL Column -->
                      <ng-container matColumnDef="cyl">
                          <th mat-header-cell *matHeaderCellDef
                              style="font-size: 16px;color:rgb(0 0 0); border: 1px solid; padding: 5px;text-align: center !important;">
                              <b *ngIf="this.BaseS != 'Single Vision'">Add</b>  <br> <b> Base </b>
                          </th>
                          <td mat-cell *matCellDef="let element"
                              style="font-size: 16px;border: 1px solid   ;  padding: 3px;  text-align: center !important; font-weight: 500;background-color: #dddddd;"
                              class="hovertblrow-col"> {{element.sph}} </td>
                      </ng-container>
                      <!-- Dynamic Columns for SPH -->
                      <ng-container *ngFor="let cyl of cylValuesS; let i = index" [matColumnDef]="cyl">
                          <th mat-header-cell *matHeaderCellDef
                              style="font-size: 16px; padding-top: 10px; color: rgb(0 0 0); border: 1px solid; text-align: center !important; background-color: #dddddd;">
                              {{ cyl }}
                          </th>
                          <!-- <td mat-cell *matCellDef="let element"
                        [style.backgroundColor]="element[cyl].isBlue ? '#fff' : 'transparent'"
                        [style.border]="element[cyl].isBlue ? '1px solid' : 'none'">
                      <ng-container *ngIf="element[cyl].isBlue">
                        <input class="inputBoxTD" type="number" [(ngModel)]="element[cyl].value" min="0"
                               [ngStyle]="{ 'color': element[cyl].value == 0 ? '#242424' : 'red', 'font-weight': element[cyl].value == 0 ? 'normal' : '900' }"
                               style="border: none !important;background: none;" disabled />
                      </ng-container>
                    </td> -->
                          <td mat-cell *matCellDef="let element"
                              [style.backgroundColor]="element[cyl].isBlue ? '#fff' : 'transparent'"
                              [style.border]="element[cyl].isBlue ? '1px solid' : 'none'"
                              [style.cursor]="element[cyl].isBlue ? 'pointer' : 'none '"
                              [ngClass]="{'disabled': element[cyl].value == 0 }"
                              (click)="element[cyl].value !== 0">
                              <ng-container *ngIf="element[cyl].isBlue">
                                  <span class="inputBoxTD"
                                      [ngStyle]="{ 'color': element[cyl].value == 0 ? '#242424' : 'red', 'font-weight': element[cyl].value == 0 ? 'normal' : '900' }"
                                      style="border: none !important;background: none; ">
                                      {{element[cyl].value}}
                                  </span>
                              </ng-container>
                          </td>
                      </ng-container>
                      <tr mat-header-row *matHeaderRowDef="displayedColumnsS" style="height: -1px !important;"
                          class="hovertblrow-col"></tr>
                      <tr mat-row *matRowDef="let row; columns: displayedColumnsS;"
                          [ngClass]="{'highlight-row': isHoveredRow(row)}" (click)="hoveredRow = row"
                          (mouseleave)="hoveredRow = null" style="height: -1px !important;" class="hovertblrow-col">
                      </tr>
                  </table>
              </div>
          </div>
          <!-- product-quantity-grid.component.html -->
  
        
      </div>
      
     
  </div>

</ng-template>

<!-- model expiry-->
<ng-template #contentR role="document" let-modal>
  <div class="modal-header" style="height: 50px;">
      <h3 class="modal-title header pt-2" id="exampleModalLabel">{{this.MonthYearHead}} List</h3>
      <button type="button" class="btn-close" aria-hidden="true" (click)="modal.dismiss('Cross click')"></button>
  </div>
  <div class="modal-body">
      <div class="row" >
        <div  class="col-sm-12"
        style="overflow: auto; height: 450px;">
          <table class="table table-striped table-hover table-sm table-bordered"
              style="border: 2px solid #fff !important;" id="saleExpiryExcel">
              <thead>
                  <tr class="text-center" style="white-space: normal;">
                      <th>S.No</th>
                      <th>Date </th>
                      <th>Amount</th>
                  </tr>
              </thead>
              <tbody class="text-center">
                  <tr *ngFor="let data of RegisterDetailList; let i = index" text="left">
                      <td>{{ i + 1 }}</td>
                      <td>{{data.PurchaseDate | date: 'dd-MM-yyyy'}}</td>
                      <td>{{data.Amount}}</td>
                  </tr>
              </tbody>
          </table>
      </div>
      </div>
  </div>
</ng-template>


